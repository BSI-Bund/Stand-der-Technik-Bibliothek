{
  "component-definition": {
    "uuid": "3e9c3e11-e05f-4955-b5ba-99d434de6107",
    "metadata": {
      "title": "SYS.1.9 Hostsysteme - Benutzerdefiniert",
      "last-modified": "2025-11-22T12:46:10.722262+00:00",
      "version": "1.0.0",
      "oscal-version": "1.1.3"
    },
    "components": [
      {
        "uuid": "2fffdb60-a75d-4bf5-ad10-dd0fceff9f0b",
        "type": "hardware",
        "title": "SYS.1.9 Hostsysteme",
        "description": "This component represents the implementation of all controls for Baustein SYS.1.9.",
        "props": [
          {
            "name": "Einleitung",
            "value": "Ein Terminalserver ist ein Server, auf dem Client-Anwendungen (kurz Anwendungen) direkt ausgeführt werden und der nur deren grafische Oberfläche (Bedienoberfläche) an die Clients weiterleitet. Hierfür wird eine Terminalserver-Software verwendet. Der Terminalserver ist dann das zugrundeliegende IT-System, auf dem diese Software ausgeführt wird. Die Eingaben am Client, z. B. über Tastatur und Maus, werden an die Terminalserver-Software übertragen, die diese Eingaben dann dem Terminalserver übergibt. In der bereitgestellten Anwendung auf dem Terminalserver werden daraufhin die Aktionen ausgeführt, die gegebenenfalls durch die Eingaben ausgelöst werden und der Terminalserver ermittelt die neue (möglicherweise geänderte) Bedienoberfläche. Diese Bedienoberfläche wird dann von der Terminalserver-Software an den Client übertragen.<BR>In einer Terminalserver-gestützten Umgebung verbinden sich typischerweise Clients mithilfe einer entsprechenden Terminal-Client-Software mit der Terminalserver-Software auf dem Terminalserver. Hierfür wird über Terminalserver-Protokolle kommuniziert, über die die Ein- und Ausgaben übertragen werden. Beispiele hierfür sind das Remote Desktop Protocol (RDP), Independent Computing Architecture (ICA), PC-over-IP (PCoIP) oder Virtual Network Computing (VNC).<BR>Die Art der auf diese Weise bereitgestellten Anwendungen ist dabei prinzipiell nicht eingeschränkt und kann beispielsweise produktive Anwendungen wie Webbrowser, Office-Anwendungen oder Finanzsoftware, aber auch Administrationswerkzeuge wie SSH-Clients oder Management-Tools umfassen.<BR>In einem typischen Einsatzszenario stellt ein Terminalserver mehreren Clients zentralisiert Anwendungen bereit, die aus organisatorischen oder technischen Gründen nicht lokal auf diesen Clients ausgeführt werden sollen oder können. Ein Beispiel hierfür sind Administrationstools, die nicht direkt auf den Clients der Administrierenden ausgeführt werden sollen. Ein weiteres Beispiel ist Software mit speziellen technischen Anforderungen an die zugrundeliegende Hardware der Clients, wie beispielsweise bestimmte Grafikkarten, die nicht auf allen Clients vorhanden sind.<BR>In einer Terminalserver-gestützten Umgebung können die Clients sogenannte Fat Clients oder Thin Clients sein. Fat Clients sind mit einem vollwertigen Client-Betriebssystem ausgestattet. Thin Clients können dagegen nur genutzt werden, um sich mit dem Terminalserver zu verbinden und diesen zu bedienen.<BR>Auf einem Terminalserver können mehrere Personen gleichzeitig auf demselben Betriebssystem arbeiten und dieselbe oder mehrere unterschiedliche Anwendungen parallel benutzen."
          },
          {
            "name": "Zielsetzung",
            "value": "Ziel dieses Bausteins ist es, Informationen zu schützen, die beim Einsatz von Terminalservern gespeichert, verarbeitet und übertragen werden. Hierzu werden spezielle Anforderungen an die beteiligten Anwendungen, IT-Systeme und Netze gestellt."
          },
          {
            "name": "Abgrenzung und Modellierung",
            "value": "Der Baustein SYS.1.9 Terminalserver ist sowohl auf den Terminalserver selbst als auch auf die zugreifenden Fat Clients und Thin Clients mit Terminal-Client-Software anzuwenden. Hierbei sind für Server und Clients jeweils sowohl die Soft- als auch die Hardwarekomponenten zu berücksichtigen.<BR>Um ein IT-Grundschutz-Modell für einen konkreten Informationsverbund zu erstellen, muss grundsätzlich die Gesamtheit aller Bausteine betrachtet werden. In der Regel sind mehrere Bausteine auf das Thema bzw. Zielobjekt anzuwenden.<BR>Dieser Baustein behandelt die folgenden Inhalte:<BR>• Ein Terminalserver im Sinne dieses Bausteins ist jedes IT-System, auf dem Anwendungen auf die oben beschriebene Weise zentral zur Verfügung gestellt werden. Hierbei muss die Verbindung vom Client aus direkt initiiert werden.<BR>• Der Baustein SYS.1.9 Terminalserver ist anzuwenden, wenn durch eine Terminal-Client-Software ausschließlich Eingaben der Benutzenden an den Terminalserver übermittelt werden.<BR>• Dieser Baustein beinhaltet spezifische Anforderungen an die verwendeten Netze, um die Kommunikation zwischen Clients und Terminalserver abzusichern.<BR>Folgende Inhalte sind ebenfalls von Bedeutung und werden an anderer Stelle behandelt:<BR>• Für den Terminalserver und die Clients müssen die Bausteine SYS.1.1 Allgemeiner Server bzw. SYS.2.1 Allgemeiner Client sowie gegebenenfalls die spezifischen Bausteine für die Server- bzw. Client-Betriebssysteme angewendet werden.<BR>• Auf die Terminalserver-Software müssen der Baustein APP.6 Allgemeine Anwendung sowie gegebenenfalls entsprechende weitere Bausteine der Schicht APP Anwendungen angewendet werden.<BR>• Für die Anwendungen, die über den Terminalserver bereitgestellt werden, müssen zusätzlich der Baustein APP.6 Allgemeine Anwendung sowie gegebenenfalls die entsprechenden spezifischen Bausteine der Schicht APP Anwendungen angewendet werden.<BR>• Der Baustein NET.1.1 Netzarchitektur und -design muss angewendet werden, um die für die Kommunikation zwischen Clients und Terminalserver verwendeten Netze abzusichern.<BR>Dieser Baustein behandelt nicht die folgenden Inhalte:<BR>• Fernwartungswerkzeuge sind keine Terminalserver im Sinne dieses Bausteins. Um diese Werkzeuge abzusichern, ist der Baustein OPS.1.2.5 Fernwartung umzusetzen.<BR>• Wenn ein zu administrierendes IT-System über Terminalserver-Protokolle angesprochen wird, stellt dies keine Nutzung des Terminalservers im Sinne dieses Bausteins dar.<BR>• Dieser Baustein adressiert nicht den Fall, dass Clients direkt auf andere Clients über Terminalserver-Protokolle oder Kollaborationswerkzeuge zugreifen.<BR>• Falls der Terminalserver-Dienst über zusätzliche Sicherheitskomponenten wie Application Delivery Controller (ADC, siehe Kapitel 4 Weiterführende Informationen) zur Verfügung gestellt wird, sind diese zusätzlichen Komponenten gesondert zu betrachten."
          },
          {
            "name": "2.1. Qualitätsverlust der Anwendungsbereitstellung",
            "value": "Eine vom Terminalserver bereitgestellte Anwendung wird in Echtzeit genutzt. Da die Bedienoberfläche auf dem Terminalserver vorbereitet und an die Clients übertragen wird, kann nur reibungslos gearbeitet werden, wenn die Antwort des Terminalservers auf eine Eingabe ohne merkliche Zeitverzögerung und klar erkennbar bei den Clients ankommt. Empfangen die Clients die Antworten des Terminalservers zeitlich verzögert, kann die Bedienbarkeit soweit einschränkt sein, dass dies einem Ausfall des Dienstes gleichkommt. Sowohl eine konstant hohe Verzögerung als auch häufig auftretende und nicht vorhersehbare Spitzen können diesen Effekt hervorrufen.<BR>Eine zu hohe Verzögerung kann durch eine zu hohe Latenz der Übertragungsstrecken oder Netzkomponenten hervorgerufen werden. Wird die Kommunikation beispielsweise über weitere Sicherheitskomponenten wie VPN-Gateways abgesichert, die möglicherweise unzureichend dimensioniert sind, kann die Verzögerung weiter erhöht werden. Dies kann dazu führen, dass die Anwendung nur noch eingeschränkt genutzt werden kann.<BR>Ist der Terminalserver stark ausgelastet, kann dieser nur verzögert antworten. Ist beispielsweise die CPU oder der Arbeitsspeicher unzureichend dimensioniert, kann der Terminalserver schnell überlasten und schließlich nur verzögert antworten. Ähnliches gilt, wenn der Terminalserver von zu vielen Personen zeitgleich genutzt wird.<BR>Ist der Bildschirminhalt nicht klar genug erkennbar, kann mit dem Terminalserver nicht mehr effizient gearbeitet werden. Beispielsweise können Schrift oder Mauszeiger aufgrund von Kompressionsartefakten schwer zu erkennen sein, falls nicht genügend Leitungskapazität zur Verfügung steht.<BR>All dies kann dazu führen, dass die Benutzenden entweder nicht oder nur noch stark eingeschränkt den Terminalserver nutzen können."
          },
          {
            "name": "2.2. Ausfall der Anwendungsbereitstellung",
            "value": "In einer Terminalserver-gestützten Umgebung werden Anwendungen zentral ausgeführt und deren Ausgabe an die entsprechenden Clients übertragen. Ist der Terminalserver nicht verfügbar, können keine Eingaben mehr verarbeitet werden und die von dem Terminalserver bereitgestellten Anwendungen versagen unmittelbar ihren Dienst. Beziehen die Clients ihre gesamte Bedienoberfläche vom Terminalserver, fällt aus der Perspektive der Benutzenden das IT-System vollständig aus.<BR>Wenn der Client ausfällt, kann hierüber nicht auf die vom Terminalserver bereitgestellten Anwendungen zugriffen werden, auch wenn diese dort verfügbar sind. Ähnliches gilt, wenn die Verbindung zwischen Client und Terminalserver gestört ist.<BR>Von Ausfällen des Netzes oder des Terminalservers sind in der Regel nicht nur einzelne Clients betroffen. In vielen Fällen sind zahlreiche oder sogar alle Clients einer Institution auf den Terminalserver angewiesen. Fällt der Terminalserver aus, ist in diesem Fall eine große Anzahl von Clients gleichzeitig betroffen."
          },
          {
            "name": "2.3. Unzureichende Netztrennung für Terminalserver",
            "value": "Auf Terminalservern werden meist Anwendungen bereitgestellt, die als Client fungieren. Hierdurch ähnelt ein Terminalserver von der Vertrauenswürdigkeit her eher einem Client als einem Server.<BR>Wird dies bei der Netztrennung nicht geeignet berücksichtigt, kann unter Umständen über den Terminalserver unberechtigterweise auf weitere Serveranwendungen zugegriffen werden, beispielsweise über einen Webbrowser. Hierdurch kann der Terminalserver als Ausgangspunkt für Angriffe auf weitere IT-Systeme und Anwendungen missbraucht werden.<BR>Durch die Eingaben am Client ist ein hoher Grad an Interaktion mit dem Terminalserver zu erwarten. Hierdurch können mögliche Schwachstellen leichter ausgenutzt werden. Dies ist insbesondere dann relevant, wenn ein Terminalserver Anwendungen für Benutzendengruppen bereitstellt, die unterschiedlichen Netzsegmenten zugeordnet sind. In diesem Fall könnte vom Terminalserver aus unautorisiert auf weitere Anwendungen in diesen Netzsegmenten zugegriffen werden."
          },
          {
            "name": "2.4. Unzureichende Absicherung von Sitzungen auf dem Terminalserver",
            "value": "Terminalserver können unterschiedlichen Clients dedizierte Anwendungsinstanzen bereitstellen, die auf demselben Betriebssystem ausgeführt werden. Dabei teilen sich die Anwendungen unter anderem gemeinsam genutzte Bibliotheken, den Kernel und die benötigten Ressourcen des Terminalservers (z. B. CPU oder RAM).<BR>Aufgrund von Fehlkonfigurationen oder Software-Schwachstellen können einzelne Anwendungsinstanzen gegebenenfalls miteinander kommunizieren, ohne dass dies ursprünglich vorgesehen war. Werden beispielsweise Sitzungen auf Terminalservern mit zu weitreichenden Berechtigungen ausgeführt, kann unter Umständen aus einer Anwendung heraus auf beliebige Teile des Dateisystems zugegriffen werden. Dies kann beispielsweise über Programmdialoge zum Speichern oder Öffnen von Dateien ausgenutzt werden, über die nicht vorgesehene Bereiche der Festplatte beschrieben oder gelesen werden.<BR>Ein weiteres Beispiel ist das sogenannte RDP Session Hijacking, das auf den Sitzungen des Terminalservers selbst beruht. Bleiben Benutzende weiterhin angemeldet, nachdem ihre Sitzungen am Terminalserver beendet sind, kann dies zu Problemen führen. Sind Angreifende mit entsprechenden Rechten ausgestattet, die sie beispielsweise durch ein unzureichendes Rechtemanagement oder durch Ausnutzen von Software-Schwachstellen zuvor erhalten haben, können sie unter Umständen aus einer anderen Sitzung heraus eine bestehende Sitzung übernehmen. In diesem Fall können Angreifende die Sitzung im Kontext des oder der Benutzenden fortsetzen.<BR>Wird das Betriebssystem von mehreren Anwendungen oder Anwendungsinstanzen gemeinsam genutzt, können gegebenenfalls Sitzungen anderer Benutzenden über CPU oder RAM beeinflusst werden. Hierfür müssen in den entsprechenden Anwendungen entsprechende Sicherheitslücken vorhanden sein, über die die benötigte Schadsoftware ausgeführt werden kann. Beispielsweise kann dann eine spezielle Schadsoftware Passwörter aus dem RAM auslesen. Auch ohne Sicherheitslücken in der Software können durch Sicherheitslücken in der Hardware (z. B. Meltdown) Angreifende beliebige schützenswerte Daten anderer Sitzungen auslesen."
          },
          {
            "name": "2.5. Unzureichende Absicherung des Terminalserver-Protokolls",
            "value": "Viele Terminalserver-Protokolle bieten die Möglichkeit einer authentisierten und verschlüsselten Kommunikation. Diese Möglichkeit ist jedoch nicht immer ausreichend, um die Kommunikation abzusichern. Nutzt das Terminalserver-Protokoll veraltete und angreifbare Mechanismen oder werden durch Fehlkonfigurationen wichtige Sicherheitsfunktionen abgeschaltet, kann die Kommunikation zwischen Clients und Terminalserver abgehört werden. Informationen, die zwischen dem Terminalserver und den Clients übertragen werden und unter Umständen abgehört oder verändert werden, sind insbesondere:<BR>• Authentisierungsinformationen und Eingaben von Benutzenden, die von den Clients zu den Terminalservern gesendet werden,<BR>• Bildschirminformationen, die auf den Clients ausgegeben werden,<BR>• Daten aus der Zwischenablage,<BR>• Dateitransfers zwischen den lokalen Laufwerken des Clients und dem Server sowie<BR>• Informationen von umgeleiteten Geräten des Clients (z. B. Audiogeräte, serielle- oder parallele Schnittstellen, USB-Geräte und Drucker).<BR>Aber auch wenn die Protokollmechanismen die Kommunikation grundsätzlich stark genug absichern, kann die Implementierung des Protokolls innerhalb eines Terminalservers oder einer Terminal-Client-Software Schwachstellen beinhalten. Dies kann dazu führen, dass der Terminalserver direkt angreifbar wird, ohne dass die Kommunikation ausgespäht werden muss."
          },
          {
            "name": "2.6. Unberechtigte Nutzung von Sammelkonten",
            "value": "Falls mehrere Personen eine Anwendung auf einem Terminalserver zu unterschiedlichen Zeiten nutzen wollen, werden oft Sammelkonten eingerichtet. Dies kann jedoch internen Regelungen oder den Lizenzbedingungen der über den Terminalserver bereitgestellten Software widersprechen.<BR>Werden Sammelkonten verwendet, verhindert dies auch, dass die auf dem Terminalserver ausgeführten Aktionen konkreten Personen zugeordnet werden können. Hierdurch kann nicht mehr nachvollzogen werden, wer was getan hat. Dies kann insbesondere ein rechtliches Risiko bedeuten, wenn es gesetzliche Anforderungen an die Nachvollziehbarkeit gibt, z. B. falls auf dem Terminalserver personenbezogene Daten verarbeitet werden."
          },
          {
            "name": "2.7. Ungeeignete Einschränkung der Zugriffsrechte der Benutzenden",
            "value": "Ein Terminalserver kann zeitgleich sowohl als Server und bezogen auf die auf ihm ausgeführten Anwendungen auch als Client fungieren. Dies kann zu Fehlern in der Vergabe der Zugriffsrechte führen.<BR>Sichere Konfigurationen von IT-Systemen und Anwendungen sehen zumeist eine möglichst restriktive Rechtevergabe vor. Dies gilt insbesondere auch für Terminalserver. Werden die Berechtigungen für die Benutzung eines Terminalservers jedoch zu weit eingeschränkt, können die Benutzenden die bereitgestellten Anwendungen nur noch stark eingeschränkt nutzen. Dies kann sowohl aus einer zu strengen Richtlinie als auch aus einer Fehlkonfiguration resultieren.<BR>Wird die Arbeit durch solche Einschränkungen zu sehr erschwert, indem beispielsweise der Schreibzugriff auf lokale Laufwerke komplett verboten wird, kann dies unerwünschte Auswirkungen haben. Beispielsweise könnten Benutzende auf nicht vorgesehene Workarounds ausweichen und Daten z. B. nach einem Export über Datenaustauschplattformen an ungeeigneter Stelle verarbeiten."
          },
          {
            "name": "2.8. Ungeeignete Anwendungen für den Einsatz auf Terminalservern",
            "value": "Nicht alle Anwendungen lassen sich auf beliebigen Terminalservern bereitstellen. Werden beispielsweise notwendige Funktionen der Graphics Processing Unit (GPU) in der emulierten Grafikeinheit nicht unterstützt, können 3D-Anwendungen über einen Terminalserver nicht oder nur eingeschränkt genutzt werden. Ähnliches gilt, wenn Eingaben von anwendungs- oder branchenspezifischen Peripheriegeräten vom Terminalserver, der Terminal-Client-Software oder dem Terminalserver-Protokoll nicht unterstützt werden.<BR>Werden einzelne Anwendungsfunktionen oder die Anbindung von Peripheriegeräten vor der Beschaffung nicht oder nur unzureichend getestet, werden diese Einschränkungen möglicherweise erst im laufenden Betrieb festgestellt. Dadurch kann die Verfügbarkeit der Anwendung erheblich eingeschränkt sein und der Terminalserver kann möglicherweise nicht wie vorgesehen eingesetzt werden. Gegebenenfalls muss er sogar komplett ersetzt werden."
          }
        ],
        "control-implementations": [
          {
            "uuid": "7b3d4c47-19cd-45ea-9c31-32c3253045c8",
            "source": "https://raw.githubusercontent.com/AG-3-Nutzergenerierte-Inhalte/Stand-der-Technik-Bibliothek/refs/heads/main/Kompendien/Grundschutz%2B%2B-Kompendium/profile/hostsysteme_profile.json",
            "description": "Implementation for all controls in Baustein SYS.1.9",
            "implemented-requirements": [
              {
                "uuid": "8f0878b8-13a7-4fd2-a862-e64cc3888959",
                "control-id": "ARCH.2.2.3",
                "description": "",
                "props": [
                  {
                    "name": "level",
                    "value": "1",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "phase",
                    "value": "Implementation",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "practice",
                    "value": "ARCH",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_c",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_i",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_a",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  }
                ],
                "statements": [
                  {
                    "statement-id": "sys.1.9-a8-m2",
                    "uuid": "12aa6bb7-01e8-4b54-b8d4-5117999e8daa",
                    "description": "Maturity Level 2: Foundational",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Der Terminalserver wird in einem allgemeinen Server-Netzwerk platziert. Es gibt keine spezifische Segmentierung, die seiner besonderen Rolle als client-ähnliches System Rechnung trägt."
                      },
                      {
                        "name": "guidance",
                        "value": "Der Server wird in dasselbe VLAN wie die meisten anderen Anwendungsserver gestellt. Die Firewall-Regeln zwischen den Servern sind oft sehr freizügig, was dem Terminalserver potenziell weitreichenden Zugriff auf Backend-Systeme ermöglicht."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer analysiert den Netzwerkplan und die Firewall-Konfiguration und stellt fest, dass der Terminalserver im gleichen Segment wie kritische Backend-Server liegt und die Kommunikation zwischen ihnen kaum eingeschränkt ist."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a8-m3",
                    "uuid": "cc337e65-9d17-43b8-95fe-37c4639ebb60",
                    "description": "Maturity Level 3: Defined",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Der Terminalserver MUSS in einem dedizierten Netzsegment oder in einem Client-Netzsegment positioniert werden. Eine bestehende Netztrennung (z.B. zwischen Client- und Server-Netzen) DARF NICHT über einen Terminalserver umgangen werden können. Dies muss durch entsprechende Firewall-Regeln sichergestellt werden."
                      },
                      {
                        "name": "guidance",
                        "value": "Für die Terminalserver wird ein eigenes VLAN (z.B. 'Terminal-Server-Zone') eingerichtet. Auf der Firewall werden Regeln erstellt, die die Kommunikation dieses Segments steuern. Insbesondere wird der Zugriff vom Terminalserver-Segment auf kritische Server-Segmente (z.B. Datenbank- oder Storage-Netze) auf die absolut notwendigen Ports und Protokolle beschränkt."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer überprüft den Netzwerkplan und die Firewall-Konfiguration, um sicherzustellen, dass sich der Terminalserver in einem angemessenen Segment befindet. Die Firewall-Regeln, die den ausgehenden Verkehr vom Terminalserver-Segment regeln, werden analysiert, um zu verifizieren, dass keine Umgehung der Sicherheitszonen möglich ist."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a8-m4",
                    "uuid": "acf291fb-ad21-45d6-a7f2-fc0d69295ce1",
                    "description": "Maturity Level 4: Enhanced",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Der Terminalserver wird in einer dedizierten DMZ-ähnlichen Zone platziert. Jeglicher Datenverkehr zu und von diesem Server, sowohl von Clients als auch zu Backend-Systemen, wird durch eine Firewall mit strengen 'Default-Deny'-Regeln kontrolliert und detailliert protokolliert."
                      },
                      {
                        "name": "guidance",
                        "value": "Die Terminalserver-Zone ist an der Firewall als eigene Schnittstelle konfiguriert. Jede benötigte Verbindung (z.B. zu einem bestimmten Applikationsserver auf Port TCP/1234) muss explizit durch eine eigene Firewall-Regel genehmigt werden. Alle anderen Verbindungen werden blockiert und geloggt."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer führt eine detaillierte Überprüfung der Firewall-Regelsätze für die Terminalserver-Zone durch. Es wird geprüft, ob eine 'Any-Any-Allow'-Regel fehlt und ob alle Regeln nach dem Minimalprinzip erstellt wurden. Die Firewall-Logs werden auf blockierte Verbindungsversuche analysiert."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a8-m5",
                    "uuid": "f0994288-c9d2-4bb0-94de-b12e7d5b02e1",
                    "description": "Maturity Level 5: Comprehensive",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Mikrosegmentierung wird eingesetzt, um jeden Terminalserver und potenziell sogar einzelne Anwendungen darauf voneinander zu isolieren. Die Kommunikationsrichtlinien werden auf der Ebene der Workloads durchgesetzt, unabhängig von ihrer Netzwerkadresse oder ihrem Standort, und folgen einem reinen Whitelist-Ansatz."
                      },
                      {
                        "name": "guidance",
                        "value": "Eine Mikrosegmentierungslösung (z.B. VMware NSX, Illumio) wird implementiert. Richtlinien werden basierend auf Metadaten (Labels) wie 'Anwendung: SAP', 'Umgebung: Produktion' definiert. Die Richtlinie 'SAP-App-Server dürfen nur über Port X mit SAP-DB-Servern kommunizieren' wird auf den virtuellen Netzwerkkarten der beteiligten VMs durchgesetzt, selbst wenn sie sich im selben Subnetz befinden."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer analysiert die definierten Mikrosegmentierungs-Richtlinien und deren Anwendung auf die Terminalserver-Workloads. Es wird die Visualisierung des erlaubten und blockierten Datenverkehrs in der Managementkonsole überprüft. Durch einen Portscan von einem Terminalserver aus wird verifiziert, dass nur die explizit erlaubten Ports auf Backend-Systemen erreichbar sind."
                      }
                    ]
                  }
                ]
              },
              {
                "uuid": "5bfe8d11-d548-4d87-9043-f9834a8d3c9b",
                "control-id": "ARCH.7.2",
                "description": "",
                "props": [
                  {
                    "name": "level",
                    "value": "5",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "phase",
                    "value": "Implementation",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "practice",
                    "value": "ARCH",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_c",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_i",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_a",
                    "value": "false",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  }
                ],
                "statements": [
                  {
                    "statement-id": "sys.1.9-a20-m3",
                    "uuid": "bc7c8e3b-8742-4f63-97a5-bcbf648fcacf",
                    "description": "Maturity Level 3: Defined",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Die Benutzenden von Terminalservern SOLLTEN anhand ähnlicher Berechtigungen und benötigter Anwendungen gruppiert werden. Ein Terminalserver SOLLTE NICHT mehreren Gruppen von Benutzenden zur Verfügung gestellt werden. Ist dies nicht möglich, SOLLTEN dedizierte Terminalserver pro Geschäftsprozess eingesetzt werden."
                      },
                      {
                        "name": "guidance",
                        "value": "Es werden separate Terminalserver-Farmen (Silos) für verschiedene Benutzergruppen oder Sicherheitszonen aufgebaut. Beispielsweise gibt es eine Farm für die interne Verwaltung, eine für die Entwicklungsabteilung und eine weitere für externe Partner. Die Trennung erfolgt durch separate Server-VMs."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer analysiert die Architektur der Terminalserver-Umgebung und verifiziert, dass separate Server oder Farmen für die definierten Gruppen existieren. Es wird geprüft, welche Benutzergruppen auf welche Farm zugreifen dürfen."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a20-m4",
                    "uuid": "58c4b189-0c59-4715-bfd3-799ba7761fd4",
                    "description": "Maturity Level 4: Enhanced",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Die Trennung zwischen den verschiedenen Terminalserver-Farmen wird auf Netzwerkebene durchgesetzt. Firewall-Regeln verhindern jegliche direkte Kommunikation zwischen den Servern der unterschiedlichen Silos. Jedes Silo befindet sich in einem eigenen, dedizierten Netzsegment."
                      },
                      {
                        "name": "guidance",
                        "value": "Jede Terminalserver-Farm wird in einem eigenen VLAN platziert. Auf der zentralen Firewall werden Regeln konfiguriert, die jeglichen Datenverkehr zwischen diesen VLANs blockieren (deny inter-VLAN-routing), es sei denn, es gibt eine explizit genehmigte und dokumentierte Ausnahme."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer analysiert die Netzwerktopologie und die Firewall-Regeln zwischen den Terminalserver-Segmenten. Mit einem Portscanner wird von einem Server in Silo A versucht, einen Server in Silo B zu erreichen, um die Wirksamkeit der Trennung zu überprüfen."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a20-m5",
                    "uuid": "09e49f6d-1353-4d37-aaa3-5b585742f18e",
                    "description": "Maturity Level 5: Comprehensive",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Für Benutzergruppen mit besonders hohem Schutzbedarf oder widersprüchlichen Sicherheitsanforderungen (z.B. Administratoren von Sicherheitssystemen vs. externe Entwickler) werden physisch getrennte Terminalserver-Umgebungen mit eigener Infrastruktur (z.B. eigene Domänencontroller, eigene Gateways) betrieben."
                      },
                      {
                        "name": "guidance",
                        "value": "Für die Verwaltung von Tier-0-Systemen wird eine dedizierte 'Privileged Access Workstation (PAW)'-Umgebung aufgesetzt. Diese ist vollständig von der Standard-IT-Infrastruktur isoliert und hat keine Verbindung zum Internet. Externe Entwickler greifen auf eine separate, in einer DMZ gehärtete Umgebung zu, die keinerlei Verbindung zu internen Produktivsystemen hat."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer analysiert die Architekturdokumentation der verschiedenen, getrennten Umgebungen. Es wird die physische oder logische Trennung der Netzwerk- und Verwaltungsinfrastruktur verifiziert. Es wird geprüft, ob es Routing-Pfade oder gemeinsame Komponenten gibt, die die Trennung unterlaufen könnten."
                      }
                    ]
                  }
                ]
              },
              {
                "uuid": "3d8b87d0-b1f7-456f-977e-7224e0a91900",
                "control-id": "ASST.2.3.1",
                "description": "",
                "props": [
                  {
                    "name": "level",
                    "value": "1",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "phase",
                    "value": "Implementation",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "practice",
                    "value": "ARCH",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_c",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_i",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_a",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  }
                ],
                "statements": [
                  {
                    "statement-id": "sys.1.9-a5-m2",
                    "uuid": "da7a6d8d-8a45-451f-ad2a-279c71768b31",
                    "description": "Maturity Level 2: Foundational",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Es gibt Empfehlungen für die zu verwendende Terminal-Client-Software und deren Version. Die Nutzung von Thin Clients oder Fat Clients wird nicht explizit geregelt, und es gibt keine Vorgaben für das Betriebssystem oder die Hardware-Konfiguration der Clients."
                      },
                      {
                        "name": "guidance",
                        "value": "Das IT-Team stellt einen Link zum Download der empfohlenen Client-Software zur Verfügung. Es gibt keine technischen Kontrollen, die die Verwendung anderer Software oder älterer Versionen verhindern."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer fragt nach den Vorgaben für Client-Systeme und stellt fest, dass nur Empfehlungen für die Software existieren. Durch eine Stichprobe von Client-Systemen wird festgestellt, dass eine heterogene Landschaft von Software-Versionen und Betriebssystemen im Einsatz ist."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a5-m3",
                    "uuid": "66891823-3b7b-4921-ab75-3c334802685b",
                    "description": "Maturity Level 3: Defined",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Es MUSS festgelegt und dokumentiert werden, über welche Terminal-Client-Software auf den Terminalserver zugegriffen werden darf. Es MUSS festgelegt werden, auf welchen Clients (Thin/Fat Clients, Hardware-Konfiguration, Betriebssystem) diese Software ausgeführt werden darf. Weiterhin MUSS festgelegt werden, welche Software zusätzlich auf den Clients zugelassen ist und ob ein Client parallel auf verschiedene Terminalserver zugreifen darf."
                      },
                      {
                        "name": "guidance",
                        "value": "Ein Client-Standard wird definiert, der die erlaubten Hardwaremodelle, Betriebssystemversionen und die exakte Version der Terminal-Client-Software vorgibt. Diese Standards werden in einer Richtlinie dokumentiert. Für die Standard-Clients werden Images erstellt, die die erlaubte Softwarekonfiguration enthalten."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer fordert die Richtlinie für Client-Systeme an und verifiziert, dass alle in der Anforderung genannten Punkte (Software, Client-Typ, Hardware, OS, Zusatzsoftware, Parallelzugriff) geregelt sind. Anhand von Stichproben wird geprüft, ob die eingesetzten Clients der Richtlinie entsprechen. Ein automatischer Check kann mit einem Inventarisierungstool erfolgen, das `Get-WmiObject Win32_Product` oder `Get-ItemProperty HKLM:\\Software\\...` verwendet."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a5-m4",
                    "uuid": "b8228547-02b3-4deb-8e93-c311a85ae50a",
                    "description": "Maturity Level 4: Enhanced",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Die Einhaltung der Client-Standards wird durch ein zentrales Client-Management-System (Unified Endpoint Management) durchgesetzt. Nur autorisierte Software kann installiert werden, und die Konfiguration der Terminal-Client-Software wird zentral verwaltet und vorgegeben."
                      },
                      {
                        "name": "guidance",
                        "value": "Ein System wie Microsoft Intune, VMware Workspace ONE oder Matrix42 wird verwendet, um Softwareverteilung, Konfigurationsmanagement und Patch-Management für alle Clients zu steuern. Die Konfiguration des Terminal-Clients (z.B. Serveradressen, Sicherheitseinstellungen) wird über das UEM-System verteilt."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer überprüft die Konfigurationsprofile und Anwendungsrichtlinien im Client-Management-System. Es werden Berichte aus dem System analysiert, um die Compliance-Rate der Clients zu ermitteln."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a5-m5",
                    "uuid": "6c8ecf85-e10a-4729-8027-2cefd1b5b3cc",
                    "description": "Maturity Level 5: Comprehensive",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Der Zugriff auf den Terminalserver wird durch eine technische Kontrolle (z.B. Network Access Control oder eine Funktion des Verbindungsgateways) an die Bedingung geknüpft, dass der Client die definierten Standards vollständig erfüllt (Device Posture Check). Clients, die nicht konform sind (z.B. veraltetes OS, fehlender Virenscanner, nicht autorisierte Software), erhalten keinen Zugriff."
                      },
                      {
                        "name": "guidance",
                        "value": "Eine NAC-Lösung (z.B. Cisco ISE, Aruba ClearPass) oder die Conditional Access Policies eines Terminal-Gateways (z.B. Citrix Gateway, Azure AD Application Proxy) werden konfiguriert, um vor dem Verbindungsaufbau den Zustand des Clients zu überprüfen. Die Überprüfung umfasst Patch-Level, Antivirus-Status, Festplattenverschlüsselung und laufende Prozesse."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer überprüft die Konfiguration der Device-Posture-Checks in der NAC- oder Gateway-Lösung. Es wird ein Test mit einem nicht-konformen Client durchgeführt, um zu verifizieren, dass der Zugriff blockiert wird. Die Logs des Systems werden auf blockierte Zugriffsversuche analysiert."
                      }
                    ]
                  }
                ]
              },
              {
                "uuid": "24673b01-df55-40e0-a22d-1f8f005fef50",
                "control-id": "BER.3.10",
                "description": "",
                "props": [
                  {
                    "name": "level",
                    "value": "3",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "phase",
                    "value": "Operation",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "practice",
                    "value": "SYS",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_c",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_i",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_a",
                    "value": "false",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  }
                ],
                "statements": [
                  {
                    "statement-id": "sys.1.9-a12-m2",
                    "uuid": "1d2718a4-e739-4c3d-bdca-9812f4366eae",
                    "description": "Maturity Level 2: Foundational",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Inaktive Sitzungen werden nach einer gewissen Zeit automatisch getrennt (disconnect), aber nicht abgemeldet. Die Anwendungen des Benutzers laufen auf dem Server weiter."
                      },
                      {
                        "name": "guidance",
                        "value": "Über Gruppenrichtlinien wird nur der Timeout für das Trennen inaktiver Sitzungen konfiguriert. Dies schützt vor unbefugtem Zugriff auf einen ungesperrten Client, lässt aber potenziell ressourcenintensive Prozesse auf dem Server weiterlaufen und birgt das Risiko des Session Hijackings."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer analysiert die GPOs für Sitzungs-Timeouts und stellt fest, dass nur der 'disconnect' Timeout gesetzt ist. Es wird eine Sitzung gestartet, gewartet, bis sie getrennt wird, und dann auf dem Server geprüft (z.B. mit dem Task-Manager), ob die Prozesse des Benutzers noch laufen."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a12-m3",
                    "uuid": "89829a44-2bff-4efe-b28b-0bef33108dfd",
                    "description": "Maturity Level 3: Defined",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Inaktive Sitzungen SOLLTEN nach einem vordefinierten Zeitraum beendet (abgemeldet) werden. Der Zeitraum SOLLTE abhängig von der Benutzergruppe festgelegt werden. Benutzer SOLLTEN über die bevorstehende automatische Beendigung benachrichtigt werden. Der Benutzer SOLLTE automatisch vom Betriebssystem abgemeldet werden."
                      },
                      {
                        "name": "guidance",
                        "value": "Über Gruppenrichtlinien werden zwei Timeouts konfiguriert: Ein kürzerer für das Trennen der Sitzung (z.B. 30 Minuten Inaktivität) und ein längerer für das vollständige Abmelden der getrennten Sitzung (z.B. 60 Minuten nach dem Trennen). Die Windows-Standardbenachrichtigung wird verwendet, um den Benutzer zu warnen."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer überprüft die GPO-Einstellungen für Sitzungs-Timeouts (sowohl für 'disconnect' als auch für 'logoff'). Es wird verifiziert, dass die Abmeldung nach dem definierten Zeitraum tatsächlich erfolgt. Automatisiert können die relevanten Registry-Keys, die von den GPOs gesetzt werden, ausgelesen werden (`HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services`)."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a12-m4",
                    "uuid": "d0f5ab43-f5a3-43d9-b118-3edf51365033",
                    "description": "Maturity Level 4: Enhanced",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Es werden unterschiedliche Timeout-Richtlinien für verschiedene Benutzergruppen basierend auf deren Rolle und der Sensitivität der genutzten Daten angewendet. Privilegierte Benutzer oder Benutzer, die auf kritische Daten zugreifen, haben deutlich kürzere Inaktivitäts-Timeouts. Die Benachrichtigung ist anpassbar und gibt dem Benutzer ausreichend Zeit zu reagieren."
                      },
                      {
                        "name": "guidance",
                        "value": "Es werden mehrere GPOs mit unterschiedlichen Timeout-Einstellungen erstellt und über Sicherheitsgruppen-Filterung auf die jeweiligen Benutzergruppen angewendet. Zum Beispiel erhält die Gruppe 'Admins' einen Timeout von 15 Minuten, während die Gruppe 'Standardbenutzer' einen Timeout von 60 Minuten hat."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer analysiert die verschiedenen GPOs und deren Verknüpfung mit den Benutzergruppen. Stichprobenartig wird für Benutzer aus verschiedenen Gruppen getestet, ob der korrekte Timeout angewendet wird."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a12-m5",
                    "uuid": "1214e6a0-2e36-448a-a935-ff16732b03f5",
                    "description": "Maturity Level 5: Comprehensive",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Die Timeout-Werte sind dynamisch und kontextabhängig. Das System berücksichtigt Faktoren wie den Netzwerkstandort des Clients (intern vs. extern), den Sicherheitsstatus des Geräts oder die Tageszeit, um das Risiko zu bewerten und den Timeout entsprechend anzupassen. Alle Abmeldeereignisse werden zentral protokolliert und auf Anomalien überwacht."
                      },
                      {
                        "name": "guidance",
                        "value": "Ein Skript, das durch den Taskplaner getriggert wird, oder eine erweiterte Funktion eines Terminalserver-Gateways wird verwendet, um die Sitzungen zu überwachen. Basierend auf den Sitzungsparametern (z.B. Client-IP-Adresse) wird dynamisch der passende Timeout für die Abmeldung gesetzt. Die Abmeldeereignisse werden an ein SIEM gesendet, das auf ungewöhnliche Muster prüft (z.B. hunderte Abmeldungen in kurzer Zeit)."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer analysiert das Skript oder die Konfiguration der Gateway-Richtlinien für die dynamischen Timeouts. Es wird getestet, ob eine Sitzung von einem als 'unsicher' klassifizierten Standort einen kürzeren Timeout erhält als eine Sitzung aus dem internen Netz. Die SIEM-Regeln zur Überwachung der Abmeldeereignisse werden überprüft."
                      }
                    ]
                  }
                ]
              },
              {
                "uuid": "0934f13b-bf9a-46e3-a3d1-96ba855450e9",
                "control-id": "DET.3.1.9",
                "description": "",
                "props": [
                  {
                    "name": "level",
                    "value": "3",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "phase",
                    "value": "Operation",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "practice",
                    "value": "DET",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_c",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_i",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_a",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  }
                ],
                "statements": [
                  {
                    "statement-id": "sys.1.9-a13-m2",
                    "uuid": "126052b4-59c3-4bb1-aecb-0aa0c9646c73",
                    "description": "Maturity Level 2: Foundational",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Die Protokollierung auf dem Terminalserver ist mit den Standardeinstellungen des Betriebssystems aktiviert. Die Protokolle werden lokal auf dem Server gespeichert und nicht zentral gesammelt oder regelmäßig ausgewertet."
                      },
                      {
                        "name": "guidance",
                        "value": "Die Windows-Ereignisanzeige enthält die Standardprotokolle. Diese werden nur bei akuten Problemen reaktiv durch einen Administrator eingesehen. Eine proaktive Überwachung findet nicht statt. Die Protokolle werden nach kurzer Zeit überschrieben."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer öffnet die Ereignisanzeige auf dem Terminalserver und überprüft die Konfiguration der Protokollgröße und Aufbewahrungsrichtlinien. Es wird festgestellt, dass keine zentrale Protokollsammlung konfiguriert ist."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a13-m3",
                    "uuid": "e15cb99b-9832-4e2c-bbe2-efaef3c8e81b",
                    "description": "Maturity Level 3: Defined",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Es SOLLTE entschieden werden, welche Ereignisse an eine zentrale Protokollierungsinfrastruktur übermittelt werden. Hierbei SOLLTEN mindestens folgende spezifischen Ereignisse protokolliert werden: Anbindung von Peripheriegeräten der Clients, Aktionen auf dem Server durch Clients, die erweiterte Rechte benötigen, sowie Konfigurationsänderungen am Terminalserver-Dienst."
                      },
                      {
                        "name": "guidance",
                        "value": "Die Überwachungsrichtlinien auf dem Terminalserver werden über GPOs so konfiguriert, dass die geforderten Ereignisse (z.B. durch Aktivierung der 'Audit PNP Activity' und erweiterter Prozessüberwachung) generiert werden. Ein Agent (z.B. Winlogbeat, NXLog) wird auf dem Server installiert, der diese Ereignisse an ein zentrales Log-Management-System (z.B. Graylog, ELK-Stack) weiterleitet."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer überprüft die Konfiguration der Überwachungsrichtlinien (Audit Policies) auf dem Terminalserver. Es wird verifiziert, dass ein Log-Forwarding-Agent installiert und korrekt konfiguriert ist. Im zentralen Log-Management-System wird stichprobenartig nach den geforderten Ereignistypen gesucht."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a13-m4",
                    "uuid": "3e072378-0e7e-451f-87c7-53c18e5ab728",
                    "description": "Maturity Level 4: Enhanced",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Die zentral gesammelten Protokolle werden durch automatisierte Regeln und Dashboards überwacht. Für kritische Ereignisse (z.B. eine Konfigurationsänderung am Terminalserver-Dienst) werden automatisch Alarme generiert, die den IT-Betrieb informieren."
                      },
                      {
                        "name": "guidance",
                        "value": "Im zentralen Log-Management-System oder SIEM werden spezifische Dashboards für die Terminalserver-Überwachung erstellt. Korrelationsregeln werden definiert, die z.B. alarmieren, wenn ein normaler Benutzer versucht, eine administrative Aktion auszuführen, oder wenn ein USB-Gerät angeschlossen wird, das nicht auf der Whitelist steht."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer sichtet die Dashboards und Alarmierungsregeln im Log-Management-System. Es wird geprüft, ob die Regeln die geforderten Ereignisse abdecken und ob es einen definierten Prozess zur Bearbeitung der Alarme gibt."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a13-m5",
                    "uuid": "4f9e9329-561b-4cf4-bc3f-cecb16b09a9c",
                    "description": "Maturity Level 5: Comprehensive",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Die Protokolldaten werden in einem SIEM-System mit Verhaltensanalyse-Funktionen (UEBA) angereichert und korreliert. Das System erkennt automatisch anomales Verhalten, das auf einen Angriff hindeuten könnte (z.B. ein Benutzer meldet sich zu ungewöhnlichen Zeiten an, greift auf untypische Daten zu oder startet verdächtige Prozesse), und kann automatisierte Reaktionen auslösen."
                      },
                      {
                        "name": "guidance",
                        "value": "Die Terminalserver-Protokolle werden an ein SIEM mit UEBA-Modul (z.B. Splunk UBA, Microsoft Sentinel) gesendet. Das System lernt das normale Verhalten jedes Benutzers und jeder Entität und alarmiert bei signifikanten Abweichungen. Kritische Alarme können über SOAR-Playbooks eine automatische Reaktion auslösen, z.B. die sofortige Trennung der verdächtigen Sitzung."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer überprüft die Konfiguration des UEBA-Moduls und die erlernten Verhaltensbaselines. Es werden die vom System generierten Risiko-Scores für Benutzer und die ausgelösten Anomalie-Alarme analysiert. Es wird geprüft, ob SOAR-Playbooks für die automatisierte Reaktion konfiguriert sind."
                      }
                    ]
                  }
                ]
              },
              {
                "uuid": "4de1731d-e692-4e5a-a722-9f5074b1305b",
                "control-id": "DET.4.14",
                "description": "",
                "props": [
                  {
                    "name": "level",
                    "value": "3",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "phase",
                    "value": "Operation",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "practice",
                    "value": "DET",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_c",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_i",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_a",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  }
                ],
                "statements": [
                  {
                    "statement-id": "sys.1.9-a14-m2",
                    "uuid": "c8a3b84c-0925-4d33-b28c-4d11ed52f3b7",
                    "description": "Maturity Level 2: Foundational",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Der Terminalserver wird auf grundlegende Verfügbarkeit überwacht (z.B. durch einen Ping-Check). Eine detaillierte Überwachung von Leistungsparametern findet nicht statt."
                      },
                      {
                        "name": "guidance",
                        "value": "Ein einfaches Monitoring-Tool prüft alle fünf Minuten, ob der Server auf einen Ping antwortet. Wenn nicht, wird eine E-Mail an den Administrator gesendet. CPU-, RAM- oder Netzwerkauslastung werden nicht erfasst."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer überprüft die Konfiguration des Monitoring-Tools und stellt fest, dass nur die Erreichbarkeit des Servers, aber keine Leistungsparameter überwacht werden."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a14-m3",
                    "uuid": "466892d9-8d25-404a-86dc-da7841414d31",
                    "description": "Maturity Level 3: Defined",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Der Terminalserver SOLLTE zentral überwacht werden. Hierfür SOLLTEN mindestens die Auslastung der Server-Ressourcen, die Auslastung der Netzschnittstellen sowie die verfügbare Bandbreite und Latenz an den verbundenen Clients überwacht werden. Für das Monitoring SOLLTEN vorab Schwellwerte (Baselining) ermittelt und regelmäßig überprüft werden."
                      },
                      {
                        "name": "guidance",
                        "value": "Ein zentrales Monitoring-System (z.B. Nagios, Zabbix, PRTG) wird eingesetzt, um die definierten Parameter (CPU, RAM, Netzwerk-I/O, Latenz) kontinuierlich zu erfassen. In einer anfänglichen Baselining-Phase werden die normalen Betriebswerte ermittelt. Darauf basierend werden Schwellwerte für Warnungen (z.B. CPU-Auslastung > 80%) und kritische Alarme (z.B. CPU > 95%) definiert."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer sichtet die Konfiguration der Überwachungs-Checks im Monitoring-System. Es wird überprüft, ob alle geforderten Parameter überwacht werden und ob sinnvolle, auf einem Baselining beruhende Schwellwerte definiert sind. Die Alarmierungskonfiguration wird ebenfalls geprüft. Automatisiert können die aktuellen Werte mit `Get-Counter` oder `vmstat` ausgelesen werden."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a14-m4",
                    "uuid": "a33c7142-5f13-4356-8958-9aa73fcf9f73",
                    "description": "Maturity Level 4: Enhanced",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Das Monitoring erfasst zusätzlich spezifische Metriken des Terminalserver-Dienstes, wie die Anzahl der aktiven und getrennten Sitzungen, die Latenz pro Sitzung und die von einzelnen Prozessen verursachte CPU-Last. Die Alarme werden automatisch in einem Ticketsystem erfasst."
                      },
                      {
                        "name": "guidance",
                        "value": "Spezifische Performance-Counter für die Remote Desktop Services werden in das Monitoring-System integriert. Die Alarme werden über eine API-Schnittstelle an das zentrale IT-Service-Management-Tool (z.B. Jira, ServiceNow) weitergeleitet, um eine nachverfolgbare Bearbeitung sicherzustellen."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer überprüft, ob die terminalserver-spezifischen Metriken im Monitoring-System erfasst werden. Es wird die Integration mit dem Ticketsystem verifiziert, indem ein Test-Alarm ausgelöst und geprüft wird, ob ein entsprechendes Ticket erstellt wird."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a14-m5",
                    "uuid": "5445f868-eb79-4230-be98-42cebc3247a5",
                    "description": "Maturity Level 5: Comprehensive",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Ein Application Performance Monitoring (APM)-Tool wird eingesetzt, das eine End-to-End-Sicht auf die Benutzererfahrung bietet. Es misst nicht nur die Server-Performance, sondern auch die tatsächlichen Antwortzeiten in der Anwendung, wie sie vom Benutzer wahrgenommen werden. Das System nutzt maschinelles Lernen, um anomale Leistungswerte und sich abzeichnende Probleme proaktiv zu erkennen."
                      },
                      {
                        "name": "guidance",
                        "value": "Eine APM-Lösung wie Dynatrace oder AppDynamics wird implementiert. Sie überwacht die gesamte Service-Kette von der Benutzeraktion auf dem Client über den Terminalserver bis hin zu den Backend-Datenbanken. Anhand von KI-Algorithmen werden dynamische Baselines für tausende von Metriken erstellt und Abweichungen automatisch als Probleme mit Ursachenanalyse gemeldet."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer sichtet die Service-Flow-Maps und die Dashboards zur Benutzererfahrung im APM-Tool. Es werden die automatisch erkannten Probleme und deren Ursachenanalysen überprüft. Es wird die Fähigkeit des Systems zur prädiktiven Warnung vor Kapazitätsengpässen analysiert."
                      }
                    ]
                  }
                ]
              },
              {
                "uuid": "880ea653-a30c-4e3e-9914-ebc6df00a74e",
                "control-id": "DET.4.2",
                "description": "",
                "props": [
                  {
                    "name": "level",
                    "value": "5",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "phase",
                    "value": "Operation",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "practice",
                    "value": "DET",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_c",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_i",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_a",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  }
                ],
                "statements": [
                  {
                    "statement-id": "sys.1.9-a19-m3",
                    "uuid": "a495441d-7d17-4f6d-95bb-345d54bd1c96",
                    "description": "Maturity Level 3: Defined",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Der Terminalserver wird kontinuierlich darauf überwacht, ob die in SYS.1.9.A13 beschriebenen sicherheitsrelevanten Ereignisse auftreten. Der Server wird regelmäßig auf Schwachstellen überprüft."
                      },
                      {
                        "name": "guidance",
                        "value": "Die in A13 definierten Protokolle werden an ein zentrales Log-Management-System gesendet. Dort werden einfache Alarme konfiguriert, z.B. bei der Anbindung eines Peripheriegeräts. Einmal im Monat wird ein authentifizierter Schwachstellenscan gegen den Terminalserver ausgeführt."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer überprüft die Alarmierungsregeln im Log-Management-System. Es werden die Berichte der letzten Schwachstellenscans angefordert und auf kritische, offene Schwachstellen geprüft."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a19-m4",
                    "uuid": "9c9eaea4-4e5e-4ff2-aac4-51fbc62fb8bd",
                    "description": "Maturity Level 4: Enhanced",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Der Terminalserver ist in ein Security Information and Event Management (SIEM)-System eingebunden. Die überwachten Ereignisse werden im SIEM hinsichtlich Anomalien und einfacher Angriffsmuster analysiert. Schwachstellenscans werden wöchentlich durchgeführt."
                      },
                      {
                        "name": "guidance",
                        "value": "Im SIEM werden Korrelationsregeln erstellt, die sicherheitsrelevante Ereignisse vom Terminalserver mit anderen Datenquellen (z.B. Firewall-Logs) verknüpfen. Es wird z.B. alarmiert, wenn ein Benutzerkonto innerhalb kurzer Zeit von vielen verschiedenen IP-Adressen Anmeldeversuche unternimmt. Die Ergebnisse der wöchentlichen Scans werden in einem Vulnerability-Management-Tool nachverfolgt."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer analysiert die Korrelationsregeln und Dashboards im SIEM, die für den Terminalserver relevant sind. Es wird der Prozess zur Behebung der in den wöchentlichen Scans gefundenen Schwachstellen überprüft."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a19-m5",
                    "uuid": "09293956-a4bd-4852-a4e7-53d16533c887",
                    "description": "Maturity Level 5: Comprehensive",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Das SIEM analysiert die überwachten Ereignisse automatisiert hinsichtlich komplexer Anomalien und Angriffsmuster, idealerweise unter Nutzung von Machine Learning (UEBA). Die Ergebnisse der regelmäßigen Schwachstellenscans werden automatisch mit Bedrohungsinformationen angereichert und priorisiert. Ein Endpoint Detection and Response (EDR)-Agent ist auf dem Server aktiv."
                      },
                      {
                        "name": "guidance",
                        "value": "Das SIEM nutzt ein UEBA-Modul, um Abweichungen vom normalen Benutzerverhalten zu erkennen (z.B. Ausführung seltener Befehle, Zugriff auf ungewöhnliche Ressourcen). Ein EDR-Agent (z.B. Microsoft Defender for Endpoint) überwacht das System auf verdächtige Prozessaktivitäten und Taktiken, die von Scannern nicht erkannt werden, und kann verdächtige Prozesse automatisch beenden."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer überprüft die Konfiguration und die Alarme des UEBA- und EDR-Systems. Es wird analysiert, wie das System auf simulierte Angriffe (z.B. Ausführung eines Mimikatz-ähnlichen Tools) reagiert. Es wird geprüft, ob ein Prozess zur Bearbeitung der hoch-priorisierten Alarme etabliert ist."
                      }
                    ]
                  }
                ]
              },
              {
                "uuid": "346013a6-8c5e-4ba9-99cb-429562422ca6",
                "control-id": "KONF.2.1",
                "description": "",
                "props": [
                  {
                    "name": "level",
                    "value": "1",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "phase",
                    "value": "Implementation",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "practice",
                    "value": "CON",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_c",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_i",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_a",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  }
                ],
                "statements": [
                  {
                    "statement-id": "sys.1.9-a4-m2",
                    "uuid": "4cd49eed-ffef-4c23-ad1a-61bf374a8872",
                    "description": "Maturity Level 2: Foundational",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Der Terminalserver wird mit den Standardeinstellungen installiert. Es werden nur die offensichtlichsten unsicheren Konfigurationen manuell angepasst, ohne einem dokumentierten Härtungsleitfaden zu folgen."
                      },
                      {
                        "name": "guidance",
                        "value": "Ein Administrator installiert den Server und ändert möglicherweise das Administratorpasswort und aktiviert die Windows Firewall mit Standardregeln. Eine systematische Härtung findet nicht statt."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer vergleicht die Konfiguration des Servers mit einem anerkannten Härtungsstandard (z.B. CIS Benchmarks) und stellt zahlreiche Abweichungen und die Verwendung von Standardeinstellungen fest. Es wird das Fehlen einer internen Konfigurationsvorgabe festgestellt."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a4-m3",
                    "uuid": "326c4256-a57c-4f7f-abd5-5eadec2d5a5b",
                    "description": "Maturity Level 3: Defined",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Es MÜSSEN dokumentierte Vorgaben für die sichere Konfiguration (Härtung) von Terminalservern erstellt werden. Dabei MÜSSEN Herstellerempfehlungen berücksichtigt werden. Die Vorgaben MÜSSEN vollständig umgesetzt und die Umsetzung dokumentiert werden. Die Konfigurationsvorgaben und deren Umsetzung MÜSSEN regelmäßig geprüft werden. Mindestens müssen Rollen und Berechtigungen, der Umfang der Protokollverschlüsselung, Authentisierungsfunktionen und die Möglichkeit zur Anzeige fremder Sitzungen berücksichtigt werden."
                      },
                      {
                        "name": "guidance",
                        "value": "Ein interner Härtungsleitfaden wird auf Basis von Herstellerdokumentationen und Best Practices (z.B. CIS, BSI) erstellt. Dieser Leitfaden wird als Checkliste bei jeder Serverinstallation abgearbeitet. Die Umsetzung wird über Gruppenrichtlinien (GPOs) oder Konfigurationsskripte sichergestellt. Die Konfiguration wird dokumentiert."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer fordert den Härtungsleitfaden an und vergleicht ihn stichprobenartig mit der Konfiguration eines Terminalservers. Es wird geprüft, ob die Konfiguration dokumentiert ist und ob es einen Prozess zur regelmäßigen Überprüfung gibt. Ein automatischer Check könnte die angewandten GPOs auslesen: `gpresult /r`."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a4-m4",
                    "uuid": "1d294200-fec7-4f86-8438-279e2bd6fa14",
                    "description": "Maturity Level 4: Enhanced",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Die Einhaltung der Härtungsvorgaben wird regelmäßig und automatisiert mit einem Konfigurations-Scanner überprüft. Der Härtungsleitfaden wird mindestens jährlich und bei Bekanntwerden neuer Schwachstellen oder Angriffstechniken aktualisiert."
                      },
                      {
                        "name": "guidance",
                        "value": "Ein Werkzeug wie der Microsoft Security Compliance Toolkit oder OpenSCAP wird eingesetzt, um die Serverkonfiguration automatisiert gegen die definierte Baseline zu prüfen. Abweichungen werden in einem Bericht erfasst und dem IT-Betrieb zur Behebung zugewiesen."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer sichtet die Berichte des Konfigurations-Scanners und die Tickets, die zur Behebung von Abweichungen erstellt wurden. Es wird die Revisionshistorie des Härtungsleitfadens geprüft, um dessen Aktualität zu verifizieren."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a4-m5",
                    "uuid": "7e50be5f-a638-4124-96a6-b86b36e8a71b",
                    "description": "Maturity Level 5: Comprehensive",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Die sichere Konfiguration wird durch ein Desired State Configuration Management System durchgehend erzwungen. Jede manuelle oder unautorisierte Änderung, die von der Härtungs-Baseline abweicht, wird automatisch erkannt und in Echtzeit zurückgesetzt (Self-Healing)."
                      },
                      {
                        "name": "guidance",
                        "value": "Werkzeuge wie PowerShell DSC, Ansible oder Puppet werden verwendet, um den gewünschten Konfigurationszustand des Servers zu definieren und kontinuierlich durchzusetzen. Ein Agent auf dem Server überwacht den Zustand und korrigiert Abweichungen sofort. Alle Korrekturmaßnahmen werden zentral protokolliert."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer überprüft die Konfigurationsdefinitionen (z.B. Ansible Playbooks, DSC-Konfigurationen). Um die Self-Healing-Fähigkeit zu testen, wird in einer Testumgebung eine Konfigurationsänderung manuell vorgenommen (z.B. Aktivierung eines unsicheren Dienstes) und verifiziert, dass diese Änderung innerhalb kurzer Zeit automatisch rückgängig gemacht wird. Die Protokolle des Konfigurationsmanagement-Systems werden auf entsprechende Einträge geprüft."
                      }
                    ]
                  }
                ]
              },
              {
                "uuid": "d80afdb6-c8cf-4fb1-b270-6b2842edefce",
                "control-id": "KONF.2.2",
                "description": "",
                "props": [
                  {
                    "name": "level",
                    "value": "5",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "phase",
                    "value": "Implementation",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "practice",
                    "value": "SYS",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_c",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_i",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_a",
                    "value": "false",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  }
                ],
                "statements": [
                  {
                    "statement-id": "sys.1.9-a17-m3",
                    "uuid": "dfd2c111-26fa-4e34-a4ce-2fff028ef79f",
                    "description": "Maturity Level 3: Defined",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Jegliche Kommunikation zwischen Client und Terminalserver SOLLTE geeignet verschlüsselt werden. Dabei SOLLTEN sichere Protokolle gemäß BSI TR-02102 verwendet werden."
                      },
                      {
                        "name": "guidance",
                        "value": "Der Terminalserver wird so konfiguriert, dass er ausschließlich Verbindungen mit hoher Verschlüsselungsstufe (z.B. 128-Bit-TLS) akzeptiert. Veraltete oder unsichere Protokolle und Cipher-Suiten werden deaktiviert. Die Konfiguration orientiert sich an den aktuellen Empfehlungen der BSI TR-02102 'Kryptographische Verfahren: Empfehlungen und Schlüssellängen'."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer analysiert die Konfiguration des Terminalservers (z.B. über GPOs oder lokale Richtlinien) bezüglich der erzwungenen Verschlüsselungsstufe und der aktivierten Protokolle (z.B. TLS 1.2, TLS 1.3) und Cipher-Suiten. Ein automatischer Test kann mit Tools wie `testssl.sh` oder Qualys SSL Labs gegen das Verbindungsgateway durchgeführt werden, um die Konfiguration zu verifizieren."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a17-m4",
                    "uuid": "5465f898-c11c-4266-afd5-ba016b950a30",
                    "description": "Maturity Level 4: Enhanced",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Die Konfiguration der Verschlüsselung wird automatisiert und regelmäßig auf Konformität mit den Vorgaben der BSI TR-02102 überprüft. Abweichungen werden alarmiert. Für die Server-Authentisierung werden ausschließlich Zertifikate aus einer vertrauenswürdigen, internen PKI verwendet."
                      },
                      {
                        "name": "guidance",
                        "value": "Ein Konfigurations-Scanner (wie in A4) wird mit einem Profil ausgestattet, das die Vorgaben der TR-02102 abbildet, und führt wöchentliche Scans durch. Die Terminalserver erhalten ihre Zertifikate automatisch über eine Auto-Enrollment-Funktion von einer internen Microsoft-CA."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer sichtet die Berichte des Konfigurations-Scanners. Es wird die Konfiguration der internen PKI und des Auto-Enrollments überprüft. Es wird verifiziert, dass die auf den Servern eingesetzten Zertifikate der internen Richtlinie entsprechen."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a17-m5",
                    "uuid": "db39b712-8723-4b1f-8378-75cd1ec6ad03",
                    "description": "Maturity Level 5: Comprehensive",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Die für die Verschlüsselung verwendeten privaten Schlüssel der Terminalserver werden in einem Hardware-Sicherheitsmodul (HSM) geschützt. Die Einhaltung der Verschlüsselungsrichtlinien wird in Echtzeit überwacht, und Versuche, eine unsichere Verbindung aufzubauen, werden sofort blockiert und als Sicherheitsvorfall behandelt."
                      },
                      {
                        "name": "guidance",
                        "value": "Die Terminalserver sind so konfiguriert, dass sie für alle TLS-Operationen einen netzwerkbasierten oder lokalen HSM Key Storage Provider verwenden. Ein Intrusion Prevention System (IPS) im Netzwerk analysiert den TLS-Handshake von Verbindungsversuchen und blockiert solche, die veraltete Protokolle oder schwache Cipher-Suiten verwenden."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer verifiziert die Konfiguration des Key Storage Providers auf dem Terminalserver und die Einbindung des HSMs. Die Signaturen und Regeln des IPS zur Erkennung von schwacher Kryptographie werden überprüft. Es wird ein Test mit einem Client durchgeführt, der absichtlich auf die Verwendung eines schwachen Protokolls (z.B. SSLv3) konfiguriert ist, um zu sehen, ob die Verbindung blockiert wird."
                      }
                    ]
                  }
                ]
              },
              {
                "uuid": "96c09d83-920f-42c7-ae0c-9b0f8a1cd5b1",
                "control-id": "KONF.2.4",
                "description": "",
                "props": [
                  {
                    "name": "level",
                    "value": "3",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "phase",
                    "value": "Implementation",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "practice",
                    "value": "CON",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_c",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_i",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_a",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  }
                ],
                "statements": [
                  {
                    "statement-id": "sys.1.9-a15-m2",
                    "uuid": "f7eaa881-f7e9-4ba2-b1f2-5527c9f9da93",
                    "description": "Maturity Level 2: Foundational",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Einige offensichtlich nicht benötigte Anwendungen und Dienste werden manuell deinstalliert oder deaktiviert. Eine systematische Überprüfung oder Beschränkung des Zugriffs auf Peripheriegeräte findet nicht statt."
                      },
                      {
                        "name": "guidance",
                        "value": "Ein Administrator entfernt nach der Installation des Betriebssystems einige Standard-Apps wie 'Spiele' oder 'Mail'. Peripheriegeräte wie USB-Sticks oder Drucker funktionieren ohne Einschränkungen."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer kontrolliert die Liste der installierten Programme und laufenden Dienste und stellt fest, dass immer noch viele nicht benötigte Komponenten vorhanden sind. Es wird getestet, ob der Zugriff auf lokale Client-Laufwerke oder USB-Sticks uneingeschränkt möglich ist."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a15-m3",
                    "uuid": "9c0bb62d-c662-4311-b750-d24e092f2c99",
                    "description": "Maturity Level 3: Defined",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Nicht benötigte Anwendungen auf dem Terminalserver SOLLTEN entfernt oder deren Ausführung unterbunden werden. Der Zugriff aus einer Sitzung auf Peripheriegeräte SOLLTE auf die benötigten Geräte eingeschränkt werden."
                      },
                      {
                        "name": "guidance",
                        "value": "Als Teil des Server-Build-Prozesses wird ein Skript ausgeführt, das alle nicht für den Terminalserver-Betrieb erforderlichen Windows-Features und -Anwendungen entfernt. Über Gruppenrichtlinien wird die Umleitung von Peripheriegeräten gesteuert. Beispielsweise wird die Umleitung von Laufwerken und USB-Ports deaktiviert, während die Umleitung von Druckern und der Zwischenablage erlaubt bleibt."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer analysiert das Härtungsskript und die GPO-Einstellungen zur Gerätemobilisierung. Es wird auf dem Server überprüft, welche Anwendungen und Dienste aktiv sind. In einer Testsitzung wird verifiziert, dass der Zugriff auf die gesperrten Peripheriegeräte tatsächlich blockiert ist."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a15-m4",
                    "uuid": "537778e1-5321-4cb8-97bd-4d1831c1d683",
                    "description": "Maturity Level 4: Enhanced",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Es wird eine Application-Whitelisting-Lösung im Audit-Modus betrieben, um die tatsächlich genutzten Anwendungen zu identifizieren. Der Zugriff auf Peripheriegeräte wird granular gesteuert, sodass z.B. nur bestimmte, genehmigte USB-Geräte (anhand ihrer Seriennummer) verwendet werden können."
                      },
                      {
                        "name": "guidance",
                        "value": "Windows Defender Application Control oder AppLocker wird so konfiguriert, dass die Ausführung aller Programme protokolliert wird. Dies schafft eine Baseline für eine spätere Erzwingung. Eine Device-Control-Software eines Drittherstellers wird eingesetzt, um eine feingranulare Steuerung des USB-Ports zu ermöglichen."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer überprüft die Konfiguration der Application-Whitelisting-Lösung und die erfassten Protokolle. Die Richtlinien der Device-Control-Software werden analysiert. Es wird getestet, ob ein nicht genehmigter USB-Stick blockiert wird, während ein genehmigter funktioniert."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a15-m5",
                    "uuid": "3113ac96-09c7-4da8-9e75-b3467f3da821",
                    "description": "Maturity Level 5: Comprehensive",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Application Whitelisting wird im Erzwingungsmodus betrieben. Nur explizit genehmigte und signierte Anwendungen können ausgeführt werden. Jeglicher Versuch, andere Software auszuführen, wird blockiert und alarmiert. Der Zustand der Härtung wird kontinuierlich überwacht, und Abweichungen werden automatisch korrigiert."
                      },
                      {
                        "name": "guidance",
                        "value": "Die AppLocker- oder WDAC-Richtlinien sind im 'Enforce'-Modus aktiv. Die Liste der erlaubten Anwendungen wird streng verwaltet und ist Teil des Change-Management-Prozesses. Ein Desired State Configuration Management (wie in A4) stellt sicher, dass die Härtungseinstellungen (z.B. deaktivierte Dienste) permanent erhalten bleiben."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer verifiziert, dass die Application-Whitelisting-Richtlinien im Erzwingungsmodus sind. Es wird versucht, eine nicht autorisierte portable Anwendung auszuführen, und geprüft, ob dies blockiert wird. Die Protokolle des DSC-Systems werden auf Konformitätsprüfungen und Korrekturen analysiert."
                      }
                    ]
                  }
                ]
              },
              {
                "uuid": "6fe27001-4d66-40c0-81fe-bac24d39d4e3",
                "control-id": "KONF.4.1",
                "description": "",
                "props": [
                  {
                    "name": "level",
                    "value": "3",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "phase",
                    "value": "Implementation",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "practice",
                    "value": "BER",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_c",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_i",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_a",
                    "value": "false",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  }
                ],
                "statements": [
                  {
                    "statement-id": "sys.1.9-a10-m2",
                    "uuid": "d677b245-8355-4ea2-b373-a3f73c9b3292",
                    "description": "Maturity Level 2: Foundational",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Für die Anmeldung am Terminalserver werden lokale Benutzerkonten auf dem Server selbst verwaltet. Es gibt keine zentrale Verwaltung der Identitäten und Passwörter."
                      },
                      {
                        "name": "guidance",
                        "value": "Administratoren legen für jeden Benutzer ein Konto direkt in der Computerverwaltung des Terminalservers an. Passwörter müssen auf jedem Server separat geändert werden, und die Durchsetzung von Passwortrichtlinien ist inkonsistent."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer öffnet die lokale Benutzerverwaltung (lusrmgr.msc) auf dem Terminalserver und stellt die Existenz von lokalen Benutzerkonten fest. Es wird das Fehlen einer Anbindung an ein zentrales Verzeichnis geprüft."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a10-m3",
                    "uuid": "e5bb868a-1181-4e8d-8285-854c62c6e690",
                    "description": "Maturity Level 3: Defined",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Für die Benutzung von Terminalservern SOLLTE ein zentrales System zum Identitäts- und Berechtigungsmanagement eingesetzt werden. Alle Benutzerkonten und Gruppen werden zentral verwaltet."
                      },
                      {
                        "name": "guidance",
                        "value": "Der Terminalserver wird als Mitgliedsserver in eine bestehende Active Directory-Domäne aufgenommen. Die Authentisierung erfolgt ausschließlich über Domänenkonten. Berechtigungen werden über Domänengruppen zugewiesen, die zentral verwaltet werden."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer verifiziert die Domänenmitgliedschaft des Terminalservers. Es wird geprüft, ob die Anmeldeberechtigungen und andere wichtige Berechtigungen (z.B. Dateisystem) an Domänengruppen und nicht an lokale Konten oder einzelne Domänenbenutzer gebunden sind. Automatisiert kann die Domänenzugehörigkeit mit `(Get-WmiObject Win32_ComputerSystem).Domain` geprüft werden."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a10-m4",
                    "uuid": "5c621bb1-a63c-45d8-b09f-a7036c868897",
                    "description": "Maturity Level 4: Enhanced",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Ein dediziertes Identity and Access Management (IAM)-System wird verwendet, das über die Funktionen eines reinen Verzeichnisdienstes hinausgeht. Es bietet Funktionen wie Single Sign-On (SSO) zu den Terminalserver-Anwendungen und automatisierte Workflows für die Beantragung und Genehmigung von Zugriffen."
                      },
                      {
                        "name": "guidance",
                        "value": "Der Terminalserver wird über einen Föderationsdienst (z.B. ADFS) oder einen Anwendungsproxy mit einer Cloud-IAM-Lösung (z.B. Azure AD) verbunden. Benutzer authentifizieren sich am IAM-System, das dann ein Ticket oder Token ausstellt, mit dem sich der Benutzer am Terminalserver anmeldet, ohne erneut ein Passwort eingeben zu müssen."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer analysiert die Konfiguration des IAM-Systems und des Föderationsdienstes. Es wird der Workflow für die Beantragung und Genehmigung von Berechtigungen überprüft. Es wird getestet, ob der SSO-Prozess korrekt funktioniert."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a10-m5",
                    "uuid": "342f1a1e-ddf7-4e5a-84fd-cf6b4f1a9415",
                    "description": "Maturity Level 5: Comprehensive",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Die Anbindung an das zentrale IAM-System erzwingt für alle Benutzer eine Multi-Faktor-Authentisierung (MFA). Der Zugriff für administrative Konten wird zusätzlich über eine Privileged Access Management (PAM)-Lösung gesteuert, die Passwörter verbirgt und Sitzungen aufzeichnet."
                      },
                      {
                        "name": "guidance",
                        "value": "Im IAM-System werden Conditional-Access-Richtlinien konfiguriert, die für den Zugriff auf den Terminalserver immer MFA erfordern. Administratoren können sich nicht mehr direkt am Server anmelden, sondern müssen ihre Verbindung über eine PAM-Lösung (z.B. CyberArk) aufbauen, die die Anmeldedaten automatisch einfügt und die Sitzung protokolliert."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer überprüft die MFA-Richtlinien im IAM-System. Es wird getestet, ob eine Anmeldung ohne zweiten Faktor fehlschlägt. Die Konfiguration der PAM-Lösung wird analysiert, und es wird geprüft, ob alle administrativen Konten über diese Lösung verwaltet werden und eine direkte Anmeldung blockiert ist."
                      }
                    ]
                  }
                ]
              },
              {
                "uuid": "4de62239-ecd1-4577-857d-980a83c71c28",
                "control-id": "KONF.6.1.1",
                "description": "",
                "props": [
                  {
                    "name": "level",
                    "value": "5",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "phase",
                    "value": "Implementation",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "practice",
                    "value": "SYS",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_c",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_i",
                    "value": "false",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_a",
                    "value": "false",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  }
                ],
                "statements": [
                  {
                    "statement-id": "sys.1.9-a22-m3",
                    "uuid": "1100b435-b865-47c8-a597-0766786f76c4",
                    "description": "Maturity Level 3: Defined",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Der Transfer von Anwendungsdaten zwischen dem Client und dem Terminalserver SOLLTE deaktiviert werden. Auch der Transfer der Zwischenablage SOLLTE deaktiviert werden."
                      },
                      {
                        "name": "guidance",
                        "value": "Über Gruppenrichtlinien oder Richtlinien des Verbindungsgateways werden die Funktionen 'Client-Laufwerksumleitung' und 'Zwischenablage-Umleitung' für alle Sitzungen deaktiviert. Benutzer können somit keine Dateien per Copy-Paste oder über zugeordnete Laufwerke zwischen ihrem lokalen Gerät und der Terminalserver-Sitzung verschieben."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer analysiert die entsprechenden Richtlinien (GPOs etc.) und verifiziert, dass die Umleitung von Laufwerken und der Zwischenablage deaktiviert ist. In einer Testsitzung wird versucht, eine Datei vom lokalen Desktop in die Sitzung zu kopieren, um die Wirksamkeit der Maßnahme zu überprüfen."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a22-m4",
                    "uuid": "ff75c340-b0a7-4dc3-bcf1-6b52678f24ab",
                    "description": "Maturity Level 4: Enhanced",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Die Richtlinien werden granular angewendet. Die Zwischenablage-Umleitung kann so konfiguriert werden, dass sie nur Text, aber keine Dateien oder Bilder erlaubt. Jegliche Versuche, gesperrte Transfer-Funktionen zu nutzen, werden zentral protokolliert und ausgewertet."
                      },
                      {
                        "name": "guidance",
                        "value": "Die Terminalserver-Protokoll-Richtlinien werden so verfeinert, dass die Zwischenablage nur in eine Richtung (z.B. vom Server zum Client) oder nur für bestimmte Datenformate (z.B. CF_TEXT) funktioniert. Die entsprechenden Audit-Einstellungen werden aktiviert, um fehlgeschlagene Umleitungsversuche in der Ereignisanzeige zu protokollieren und an ein SIEM weiterzuleiten."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer überprüft die granulare Konfiguration der Zwischenablage-Richtlinien. Es wird getestet, ob Text kopiert werden kann, während das Kopieren einer Datei blockiert wird. Die Protokolle im SIEM werden auf entsprechende Audit-Ereignisse analysiert."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a22-m5",
                    "uuid": "06a24757-2e8e-4e32-b24b-9938380c1473",
                    "description": "Maturity Level 5: Comprehensive",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Eine Data Loss Prevention (DLP)-Lösung ist integriert, die den Datenfluss über alle erlaubten Kanäle (z.B. erlaubte Zwischenablage, Drucken) inhaltlich überwacht. Versuche, sensible Informationen (z.B. Kreditkartennummern, Patientendaten) zu transferieren, werden erkannt und blockiert. Zusätzlich werden sichtbare Wasserzeichen in die Sitzungen eingeblend, um Screenshots zu entmutigen und zuzuordnen."
                      },
                      {
                        "name": "guidance",
                        "value": "Eine Host-basierte DLP-Lösung wird auf dem Terminalserver installiert oder eine netzwerkbasierte DLP-Lösung inspiziert den Datenverkehr des Gateways. Es werden DLP-Richtlinien definiert, die mittels regulärer Ausdrücke und Schlüsselwörtern nach sensiblen Datenmustern suchen. Die Wasserzeichenfunktion des Terminalserver-Protokolls wird aktiviert und so konfiguriert, dass sie Benutzername, IP-Adresse und Zeitstempel anzeigt."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer überprüft die Konfiguration der DLP-Richtlinien und der Wasserzeichen. Es wird getestet, ob der Versuch, eine Datei mit fingierten sensiblen Daten zu kopieren oder zu drucken, von der DLP-Lösung blockiert wird. Es wird ein Screenshot einer Sitzung angefertigt und geprüft, ob das Wasserzeichen sichtbar und korrekt ist."
                      }
                    ]
                  }
                ]
              },
              {
                "uuid": "ec44a5d5-4323-4a79-94a9-36a8cfafbcc6",
                "control-id": "KONF.6.4",
                "description": "",
                "props": [
                  {
                    "name": "level",
                    "value": "3",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "phase",
                    "value": "Implementation",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "practice",
                    "value": "CON",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_c",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_i",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_a",
                    "value": "false",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  }
                ],
                "statements": [
                  {
                    "statement-id": "sys.1.9-a11-m2",
                    "uuid": "3c55f6da-b9c4-4411-937b-8a06578542f5",
                    "description": "Maturity Level 2: Foundational",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Es werden servergespeicherte Profile (Roaming Profiles) verwendet, damit Benutzer an verschiedenen Servern dieselben Einstellungen haben. Es gibt jedoch keine spezifischen Sicherheitskonfigurationen oder Quotas für diese Profile."
                      },
                      {
                        "name": "guidance",
                        "value": "Im Active Directory wird für jeden Benutzer ein Profilpfad zu einer Dateifreigabe eingetragen. Die Standardeinstellungen für Profile werden beibehalten, was zu großen Profilen ('bloated profiles') und langen Anmeldezeiten führen kann."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer kontrolliert die Benutzereigenschaften im Active Directory auf die Verwendung von servergespeicherten Profilen. Es wird die Konfiguration der Gruppenrichtlinien für Profile überprüft und festgestellt, dass keine Härtungsmaßnahmen oder Quotas definiert sind."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a11-m3",
                    "uuid": "0dbce2bd-d69e-41f7-a876-ec7ae7eccf3a",
                    "description": "Maturity Level 3: Defined",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Benutzende SOLLTEN ihre spezifischen Einstellungen (Benutzerprofile) NICHT derart ändern dürfen, dass die Informationssicherheit oder die Nutzung des Terminalservers eingeschränkt wird. Für die Benutzerprofile SOLLTE eine geeignete maximale Größe festgelegt werden. Wenn Verbünde aus Terminalservern eingesetzt werden, SOLLTEN die Benutzendenprofile zentral abgelegt werden."
                      },
                      {
                        "name": "guidance",
                        "value": "Mittels Gruppenrichtlinien (GPOs) werden Einstellungen für Benutzerprofile durchgesetzt. Insbesondere werden Änderungen an sicherheitsrelevanten Systembereichen (z.B. Registry-Teile, Systemsteuerungselemente) für normale Benutzer blockiert. Auf der Dateifreigabe für Profile werden Quotas eingerichtet, um die maximale Profilgröße zu begrenzen."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer analysiert die Gruppenrichtlinien, die auf die Terminalserver und Benutzer angewendet werden, und sucht nach den entsprechenden Richtlinien zur Härtung von Benutzerprofilen. Die Konfiguration der Quotas auf dem Fileserver wird überprüft. Automatisiert können die GPO-Einstellungen mit `Get-GPOReport` ausgelesen werden."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a11-m4",
                    "uuid": "03c9b654-5aa6-4f3f-8d71-1bde8acb99e4",
                    "description": "Maturity Level 4: Enhanced",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Eine Lösung zur Virtualisierung von Benutzerprofilen (User Environment Virtualization) wird eingesetzt. Anstelle von klassischen Roaming Profiles werden nur die spezifischen Einstellungen der Benutzer bei An- und Abmeldung dynamisch geladen und gespeichert, was die Anmeldezeiten erheblich verkürzt und die Stabilität verbessert."
                      },
                      {
                        "name": "guidance",
                        "value": "Produkte wie Microsoft UE-V, Citrix Profile Management oder Ivanti User Workspace Manager werden implementiert. Es wird genau konfiguriert, welche Anwendungseinstellungen und Registry-Schlüssel im Profil des Benutzers gespeichert werden sollen, während der Rest des Profils bei Abmeldung verworfen wird."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer überprüft die Konfiguration der UEV-Lösung. Es wird analysiert, welche Anwendungseinstellungen und Pfade für die Synchronisierung konfiguriert sind. Die Anmeldezeiten werden stichprobenartig gemessen und mit denen bei klassischen Roaming Profiles verglichen."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a11-m5",
                    "uuid": "c1021b7f-c499-40bc-9cbd-d469acbc8d3c",
                    "description": "Maturity Level 5: Comprehensive",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Container-basierte Profillösungen werden verwendet, um das gesamte Benutzerprofil in einer VHD(X)-Datei zu kapseln, die bei der Anmeldung dynamisch gemountet wird. Dies bietet die beste Performance und Kompatibilität. Änderungen an Profilen, die die Sicherheit beeinträchtigen könnten, werden in Echtzeit überwacht und protokolliert."
                      },
                      {
                        "name": "guidance",
                        "value": "Microsoft FSLogix Profile Container wird implementiert und konfiguriert. Die Profil-Container werden auf einer hochverfügbaren und performanten Dateifreigabe gespeichert. Überwachungsregeln im SIEM werden erstellt, um verdächtige Änderungen innerhalb der gemounteten Profil-Container zu erkennen."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer überprüft die FSLogix-Konfiguration über GPOs. Es wird verifiziert, dass die Dateifreigabe für die Container hochverfügbar ist. Die SIEM-Regeln zur Überwachung von Profiländerungen werden analysiert. Es wird geprüft, ob bei der Anmeldung eines Benutzers der Profil-Container korrekt gemountet wird."
                      }
                    ]
                  }
                ]
              },
              {
                "uuid": "44f43ffa-6421-413c-b7b4-fed5e25fdcd4",
                "control-id": "KONF.6.4.1",
                "description": "",
                "props": [
                  {
                    "name": "level",
                    "value": "1",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "phase",
                    "value": "Implementation",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "practice",
                    "value": "BER",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_c",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_i",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_a",
                    "value": "false",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  }
                ],
                "statements": [
                  {
                    "statement-id": "sys.1.9-a3-m1",
                    "uuid": "b8da5a5e-c85e-4158-b9dc-0ab055368752",
                    "description": "Maturity Level 1: Partial",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Berechtigungen werden ad hoc auf Benutzerbasis vergeben. Es gibt kein definiertes Rollenkonzept. Oft werden Sammelkonten für Benutzergruppen verwendet, um den Verwaltungsaufwand zu reduzieren."
                      },
                      {
                        "name": "guidance",
                        "value": "Wenn ein neuer Benutzer Zugriff benötigt, kopiert der Administrator die Berechtigungen eines bestehenden Benutzers. Es wird nicht systematisch geprüft, ob diese Berechtigungen dem Prinzip der geringsten Rechte entsprechen."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer analysiert die Berechtigungsstruktur auf dem Terminalserver und stellt das Fehlen eines dokumentierten Rollenkonzepts fest. Durch Stichproben wird geprüft, ob Benutzer übermäßige Rechte besitzen und ob Sammelkonten verwendet werden."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a3-m2",
                    "uuid": "27b00816-c699-4a49-9e44-ceabb8dbdf1b",
                    "description": "Maturity Level 2: Foundational",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Es gibt grundlegende Rollen wie 'Benutzer' und 'Administrator'. Alle regulären Benutzer erhalten dieselben, oft zu weitreichenden Berechtigungen. Die Nutzung von Sammelkonten wird vermieden, ist aber nicht explizit verboten."
                      },
                      {
                        "name": "guidance",
                        "value": "Im Active Directory werden Gruppen wie 'TS-Users' und 'TS-Admins' erstellt und für die Zuweisung von Anmelderechten und grundlegenden Dateisystemberechtigungen verwendet. Eine feingranulare Steuerung pro Anwendung oder Funktion findet nicht statt."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer überprüft die Mitgliedschaften und Berechtigungen der eingerichteten Gruppen. Es wird verifiziert, dass keine Sammelkonten aktiv genutzt werden, stellt aber fest, dass die Berechtigungen innerhalb der 'TS-Users'-Gruppe nicht nach dem Need-to-know-Prinzip differenziert sind."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a3-m3",
                    "uuid": "2d865264-31be-4689-8d14-34d77609d739",
                    "description": "Maturity Level 3: Defined",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Es MUSS ein Rollen- und Berechtigungskonzept nach dem Prinzip der geringsten Rechte erstellt werden. Die Berechtigungen für folgende Tätigkeiten MÜSSEN mindestens festgelegt werden: Ausführen von Anwendungen in fremdem Kontext (z.B. 'root'), Zugriff auf betriebssystemspezifische Funktionen, Zugriff auf das Dateisystem des Servers und des Clients, Zugriff auf nachgelagerte Dienste sowie Datei- und Objekttransfer und Anbindung von Peripheriegeräten. Sammelkonten DÜRFEN NICHT verwendet werden, wenn es gegen interne Regelungen oder Lizenzbedingungen verstößt."
                      },
                      {
                        "name": "guidance",
                        "value": "Ein detailliertes Berechtigungskonzept wird dokumentiert, das verschiedene Benutzerrollen (z.B. 'Sachbearbeiter Finanzwesen', 'Controller', 'Administrator') definiert. Für jede Rolle werden die benötigten Zugriffe auf Anwendungen, Dateisysteme und Geräte präzise festgelegt. Die Umsetzung erfolgt durch granulare Sicherheitsgruppen und Richtlinien (z.B. GPOs)."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer fordert das Rollen- und Berechtigungskonzept an und vergleicht es mit der technischen Umsetzung auf dem Terminalserver. Stichprobenartig wird für verschiedene Rollen geprüft, ob die Berechtigungen dem dokumentierten Konzept und dem Minimalprinzip entsprechen. Es wird verifiziert, dass keine unzulässigen Sammelkonten existieren."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a3-m4",
                    "uuid": "2ab03f8f-e101-4738-91ed-44d8bd1bd207",
                    "description": "Maturity Level 4: Enhanced",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Die Rollen und Berechtigungen werden regelmäßig, mindestens halbjährlich, im Rahmen eines Re-Zertifizierungsprozesses überprüft. Die technische Trennung zwischen den Sitzungen verschiedener Benutzer wird durch zusätzliche Härtungsmaßnahmen sichergestellt, um eine unbefugte Kommunikation oder einen unbefugten Zugriff zwischen Sitzungen zu verhindern."
                      },
                      {
                        "name": "guidance",
                        "value": "Ein Identity-Management-System wird genutzt, um automatisierte Workflows für die Access-Reviews zu implementieren, bei denen die Vorgesetzten die Zugriffe ihrer Mitarbeiter bestätigen müssen. Spezifische Betriebssystem-Härtungseinstellungen werden angewendet, um die Sitzungsisolation zu verstärken."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer sichtet die Protokolle der letzten Access-Review-Kampagnen. Es wird die Konfiguration der Betriebssystem-Härtung zur Sitzungsisolation überprüft. Ein Test könnte darin bestehen, als Benutzer A zu versuchen, auf Prozesse oder Dateisystemobjekte von Benutzer B zuzugreifen."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a3-m5",
                    "uuid": "571af1c4-cda3-4843-9f0d-d471ccdebd10",
                    "description": "Maturity Level 5: Comprehensive",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Das Rollen- und Berechtigungsmanagement ist vollständig in eine zentrale IAM-Lösung (Identity and Access Management) integriert. Privilegierte Zugriffe werden über eine PAM-Lösung (Privileged Access Management) gesteuert, die Just-in-Time-Berechtigungen ermöglicht und alle privilegierten Sitzungen aufzeichnet. Jegliche Versuche des unbefugten Zugriffs zwischen Sitzungen werden in Echtzeit erkannt und blockiert."
                      },
                      {
                        "name": "guidance",
                        "value": "Eine IAM-Lösung wie Azure AD, Okta oder Keycloak verwaltet den gesamten Lebenszyklus von Identitäten und deren Zugriffen. Eine PAM-Lösung wie CyberArk oder Thycotic schleust administrative Verbindungen ein, verbirgt die Passwörter und zeichnet die Sitzungen als Video auf. Ein EDR-Agent (Endpoint Detection and Response) auf dem Server überwacht die Prozessinteraktionen und blockiert unzulässige Zugriffe."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer überprüft die Konfiguration des IAM- und des PAM-Systems. Es werden die Sitzungsaufzeichnungen von privilegierten Zugriffen stichprobenartig gesichtet. Es wird verifiziert, dass administrative Anmeldungen nur über das PAM-System möglich sind. Automatisiert könnte geprüft werden, ob der EDR-Agent aktiv ist und seine Schutzfunktionen aktiviert sind: `Get-Service -Name EDRService | Select-Object -Property Status`."
                      }
                    ]
                  }
                ]
              },
              {
                "uuid": "062f3315-e07c-4bc4-a162-24b608c3279a",
                "control-id": "KONF.7.15",
                "description": "",
                "props": [
                  {
                    "name": "level",
                    "value": "1",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "phase",
                    "value": "Implementation",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "practice",
                    "value": "BER",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_c",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_i",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_a",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  }
                ],
                "statements": [
                  {
                    "statement-id": "sys.1.9-a7-m2",
                    "uuid": "9e4d5f27-04c2-481b-9461-0a5df9452a3b",
                    "description": "Maturity Level 2: Foundational",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Der Zugriff auf den Terminalserver ist auf das interne Netz beschränkt. Die Standard-Verschlüsselung des Terminalserver-Protokolls ist aktiviert, aber es wird keine zusätzliche Absicherung wie eine VPN-Kapselung oder eine strenge gegenseitige Authentisierung verwendet."
                      },
                      {
                        "name": "guidance",
                        "value": "Die Firewall erlaubt den Zugriff aus dem gesamten LAN. Die Verschlüsselungseinstellung im Terminalserver-Dienst ist auf einem Standardwert wie 'Client-kompatibel' belassen. Benutzer authentifizieren sich mit Passwort, der Client prüft aber nicht zwingend die Identität des Servers."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer überprüft die Firewall-Regeln und die Verschlüsselungseinstellungen des Terminalserver-Dienstes. Mit einem Netzwerk-Sniffer (z.B. Wireshark) wird stichprobenartig geprüft, ob die Kommunikation verschlüsselt ist, auch wenn die Stärke der Verschlüsselung nicht optimal sein mag."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a7-m3",
                    "uuid": "76dbd209-d577-40e7-9351-26d218147c9b",
                    "description": "Maturity Level 3: Defined",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Es MUSS festgelegt werden, über welche Netze auf den Terminalserver zugegriffen werden darf. Es MUSS festgelegt werden, wie die Kommunikation abgesichert wird, inklusive der Verschlüsselung mit dem Terminalserver-Protokoll. Falls die Protokollverschlüsselung nicht ausreicht, MUSS die Kommunikation zusätzlich (z.B. per VPN) abgesichert werden. Bei Zugriff aus unzureichend vertrauenswürdigen Netzen MÜSSEN sich sowohl die Benutzenden als auch der Terminalserver authentisieren."
                      },
                      {
                        "name": "guidance",
                        "value": "Firewall-Regeln werden so konfiguriert, dass der Zugriff nur aus definierten, vertrauenswürdigen Client-Netzen erlaubt ist. Der Terminalserver wird konfiguriert, eine hohe Verschlüsselungsstufe zu erzwingen. Dem Server wird ein Zertifikat von einer vertrauenswürdigen PKI zugewiesen, damit Clients seine Identität prüfen können (Server-Authentisierung)."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer kontrolliert die Firewall-Regeln für den Zugriff auf den Terminalserver. Die Konfiguration des Terminalserver-Dienstes bezüglich Verschlüsselung und Authentisierung wird geprüft. Es wird verifiziert, dass der Server ein gültiges Zertifikat verwendet und Clients zur Prüfung dieses Zertifikats konfiguriert sind."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a7-m4",
                    "uuid": "730c73ae-fdac-49a6-8cd1-15af74104dd8",
                    "description": "Maturity Level 4: Enhanced",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Der gesamte Zugriff auf den Terminalserver wird über ein dediziertes und gehärtetes Gateway (z.B. RDP-Gateway, Citrix ADC) geleitet. Dieses Gateway erzwingt eine starke Authentisierung der Benutzer (z.B. mit Zwei-Faktor-Authentisierung) und eine Überprüfung der Client-Konformität, bevor der Zugriff auf den eigentlichen Terminalserver erlaubt wird."
                      },
                      {
                        "name": "guidance",
                        "value": "Ein Microsoft RDP Gateway oder ein vergleichbares Produkt wird in einer DMZ installiert. Es wird mit einem RADIUS-Server für die Multi-Faktor-Authentisierung (MFA) integriert. Auf dem Gateway werden Richtlinien (Connection Authorization Policies, Resource Authorization Policies) definiert, die genau festlegen, welcher Benutzer von wo auf welchen Server zugreifen darf."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer analysiert die Konfiguration des Gateways, inklusive der Anbindung an die MFA-Lösung und der definierten Zugriffsrichtlinien. Es wird getestet, ob ein Zugriff ohne zweiten Faktor oder von einem nicht autorisierten Client blockiert wird."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a7-m5",
                    "uuid": "977a809e-dda4-40f7-af5f-b46dc9ef2e5c",
                    "description": "Maturity Level 5: Comprehensive",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Der Zugriff wird nach einem Zero-Trust-Modell verwaltet. Jede einzelne Zugriffsanfrage wird individuell authentisiert und autorisiert, basierend auf der Identität des Benutzers, dem Zustand des Endgeräts und dem Kontext. Die Netzwerkverbindung wird erst nach erfolgreicher Prüfung dynamisch und nur für die spezifische Sitzung aufgebaut (Just-in-Time Access)."
                      },
                      {
                        "name": "guidance",
                        "value": "Eine Zero Trust Network Access (ZTNA)-Lösung wird implementiert. Anstatt Clients in ein Netzwerk zu lassen, baut der ZTNA-Connector des Clients einen ausgehenden, verschlüsselten Tunnel zum nächstgelegenen ZTNA-PoP auf. Nach starker Authentisierung und Überprüfung der Gerätesicherheit stellt der ZTNA-Dienst eine direkte, gesicherte Verbindung zur angeforderten Anwendung auf dem Terminalserver her, ohne dem Client breiten Netzwerkzugriff zu gewähren."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer überprüft die Zero-Trust-Zugriffsrichtlinien in der ZTNA-Managementkonsole. Es wird verifiziert, dass ein Benutzer nur auf die für ihn freigegebenen Anwendungen zugreifen kann und kein anderer Netzwerkzugriff möglich ist. Die Protokolle werden auf Zugriffsentscheidungen basierend auf Benutzer-, Geräte- und Kontext-Risiko analysiert."
                      }
                    ]
                  }
                ]
              },
              {
                "uuid": "edb67b97-3075-4621-be3e-9205dfab9523",
                "control-id": "KONF.9.3",
                "description": "",
                "props": [
                  {
                    "name": "level",
                    "value": "5",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "phase",
                    "value": "Implementation",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "practice",
                    "value": "ARCH",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_c",
                    "value": "false",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_i",
                    "value": "false",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_a",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  }
                ],
                "statements": [
                  {
                    "statement-id": "sys.1.9-a21-m3",
                    "uuid": "54d6e606-0ceb-4cdf-9f54-27308e7b3ec2",
                    "description": "Maturity Level 3: Defined",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Der Terminalserver SOLLTE hochverfügbar betrieben werden. Dazu SOLLTEN der Terminalserver sowie dessen Netzanbindung redundant ausgelegt werden. Die verwendeten Terminalserver SOLLTEN im Verbund (Cluster) betrieben werden. Für die zugreifenden Clients SOLLTEN Ersatzgeräte bereitgehalten werden."
                      },
                      {
                        "name": "guidance",
                        "value": "Mindestens zwei Terminalserver werden in einer Farm zusammengefasst und über einen Load Balancer oder einen Connection Broker betrieben. Jeder Server ist mit zwei Netzwerkkarten an zwei verschiedene Switches angeschlossen (NIC-Teaming). Im Lager werden einige vorkonfigurierte Ersatz-Clients vorgehalten."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer analysiert die Konfiguration des Connection Brokers und der Serverfarm. Die Netzwerkkonfiguration der Server wird auf Redundanz geprüft. Es wird der Bestand an Ersatz-Clients kontrolliert."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a21-m4",
                    "uuid": "7e7d4ffd-795e-49b5-83ee-9c845abea482",
                    "description": "Maturity Level 4: Enhanced",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Alle zentralen Komponenten der Terminalserver-Infrastruktur, einschließlich der Connection Broker, Lizenzserver und Gateways, sind redundant ausgelegt und verfügen über eine automatische Failover-Funktion. Die Server der Farm sind auf unterschiedliche physische Host-Systeme verteilt."
                      },
                      {
                        "name": "guidance",
                        "value": "Die Connection Broker werden im High-Availability-Modus betrieben, der eine SQL-Datenbank zur Synchronisierung des Zustands nutzt. Die Gateway-Appliances sind als HA-Paar konfiguriert. In der Virtualisierungsumgebung werden Anti-Affinitätsregeln erstellt, um sicherzustellen, dass die VMs der Terminalserver-Farm nicht auf demselben physischen Host laufen."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer überprüft die HA-Konfiguration der Broker, Gateways und der Virtualisierungsplattform. Es wird ein Failover-Test durchgeführt, indem eine aktive Komponente (z.B. ein Server oder Gateway) heruntergefahren und geprüft wird, ob die Sitzungen unterbrechungsfrei auf die redundante Komponente umgeschaltet werden."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.1.9-a21-m5",
                    "uuid": "7524d37b-6871-43f8-a8dd-eca6a61fa9de",
                    "description": "Maturity Level 5: Comprehensive",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Die Terminalserver-Infrastruktur ist auf zwei geografisch getrennte Rechenzentren verteilt (Geo-Cluster). Im Falle eines Totalausfalls eines Standorts kann der Betrieb vollständig vom zweiten Standort übernommen werden. Der Failover-Prozess ist automatisiert."
                      },
                      {
                        "name": "guidance",
                        "value": "Eine Active/Active- oder Active/Passive-Architektur wird über zwei Rechenzentren implementiert. Ein Global Server Load Balancing (GSLB)-System leitet die Benutzeranfragen an das jeweils verfügbare Rechenzentrum. Benutzerprofildaten und andere zentrale Konfigurationen werden zwischen den Standorten repliziert."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer analysiert die standortübergreifende Architektur und die Konfiguration des GSLB und der Datenreplikation. Es werden die Notfallhandbücher und die Protokolle der letzten Desaster-Recovery-Tests geprüft. Es wird verifiziert, dass ein Failover zwischen den Standorten die definierten RTO- und RPO-Ziele einhält."
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}