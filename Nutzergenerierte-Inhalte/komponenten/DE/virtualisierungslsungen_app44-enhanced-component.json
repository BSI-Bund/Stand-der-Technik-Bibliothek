{
  "component-definition": {
    "uuid": "28d36b1d-c58b-47fe-9b31-eb6fe288e879",
    "metadata": {
      "title": "APP.4.4 Kubernetes - Benutzerdefiniert",
      "last-modified": "2025-11-22T12:46:07.694891+00:00",
      "version": "1.0.0",
      "oscal-version": "1.1.3"
    },
    "components": [
      {
        "uuid": "38ae5fef-bea4-46cb-8507-c086ed11ae40",
        "type": "software",
        "title": "APP.4.4 Kubernetes",
        "description": "This component represents the implementation of all controls for Baustein APP.4.4.",
        "props": [
          {
            "name": "Einleitung",
            "value": "Kubernetes hat sich als De-Facto-Standard für die Orchestrierung von Containern in der Public und Private Cloud etabliert. Auch für IoT und andere Anwendungsfälle ist Kubernetes im Einsatz, mit K3S gibt es beispielsweise eine Edition, die für sehr kleine Server wie Einplatinencomputer gedacht ist. Auch der sogenannte Cloud Native Stack, der aus vielen verschiedenen Komponenten besteht, baut auf dem von Kubernetes etablierten Standard auf.<BR>Der Begriff Container bezeichnet eine Technik, bei der ein Host-System Anwendungen parallel in separierten Umgebungen ausführt (Operating System Level Virtualization). In den meisten Fällen erfolgt die Überwachung, das Starten und Beenden und die weitere Verwaltung der Container durch eine Verwaltungssoftware, die somit die sogenannte Orchestrierung übernimmt. Kubernetes fasst dabei einen oder mehrere zusammengehörige Container in einem Pod zusammen. Da der Fokus des Bausteins auf Kubernetes liegt, wird im Weiteren nur von Pods und nicht von einzelnen Containern gesprochen. Die Orchestrierung erfolgt dabei zumeist in Gruppen von gemeinsam verwalteten Kubernetes-Nodes in einem oder mehreren sogenannten Clustern.<BR>Um die Orchestrierung von Pods zu betreiben und diese zu verwalten, haben sich mehrere Produkte etabliert, die es erlauben, auch sehr große Umgebungen zu bedienen. In ihrem Kern setzen allerdings alle auf Kubernetes auf. Bei der Betrachtung ist zwischen der Runtime, die die Prozesse auf den Kubernetes-Nodes betreibt, und der Orchestrierung, die die Runtimes auf mehreren Kubernetes-Nodes steuert, zu unterscheiden.<BR>Zusätzlich zu diesen beiden zentralen Komponenten besteht der Betrieb von Kubernetes in den meisten Fällen noch aus einer spezialisierten Infrastruktur, zu der z. B. Registries, Code-Versionierung und -Speicherung, Automatisierungswerkzeuge, Verwaltungsserver, Speichersysteme oder virtuelle Netze gehören.<BR>Die folgenden Begriffe werden im Baustein in dieser Bedeutung verwendet:<BR>• Anwendung bezeichnet eine Zusammenstellung mehrerer Programme, die gemeinsam eine Aufgabe erfüllen<BR>• Cluster sind Betriebsumgebungen für Container mit mehreren Nodes<BR>• Container sind aus einem Image gestartete Prozesse, die innerhalb von Betriebssystem-Namespaces laufen<BR>• Container Network Interface (CNI) bezeichnet die Schnittstelle zur Verwaltung der virtuellen Netze im Cluster<BR>• Container Storage Interface (CSI) bezeichnet die Schnittstelle zu den zumeist externen Speichersystemen, die Kubernetes den Pods bereitstellen kann<BR>• Control Plane bezeichnet alle für die Verwaltung, also Orchestrierung der Nodes, Runtimes und Cluster eingesetzten Anwendungen<BR>• Images sind alle der Open Container Initiative (OCI) entsprechenden Software-Pakete, diese umfassen sowohl Basis-Images für eigene Images als auch solche Images, die unverändert im Einsatz sind<BR>• Node bezeichnet einen Server, der für den Betrieb der Runtime installiert und optimiert ist<BR>• Pod bezeichnet eine Sammlung mehrerer Container, die innerhalb der gleichen Betriebssystem-Namespaces laufen<BR>• Registry ist der Oberbegriff für die Code-Verwaltung und die Speicherung der Images<BR>• Runtime bezeichnet die Software, die die Software im Image als Container startet"
          },
          {
            "name": "Zielsetzung",
            "value": "Ziel dieses Bausteins ist der Schutz von Informationen, die in Kubernetes-Clustern verarbeitet, angeboten oder darüber übertragen werden."
          },
          {
            "name": "Abgrenzung und Modellierung",
            "value": "Der Baustein APP.4.4 Kubernetes ist immer zusammen mit dem Baustein SYS.1.6 Containerisierung anzuwenden. Dabei ist es bezogen auf den Fokus des vorliegenden Bausteins nicht relevant, welche Container-Runtime im Einsatz ist oder welche zusätzlichen Anwendungen Teil der Control Plane sind.<BR>Der Baustein enthält grundsätzliche Anforderungen zur Einrichtung, zum Betrieb und zur Orchestrierung mit Kubernetes sowie zur spezialisierten Infrastruktur, die zum Betrieb notwendig ist. Letzteres beinhaltet Registries, CSI/CNI, Nodes und Automatisierungssoftware, soweit sie direkt mit dem Cluster interagieren. Die Anforderungen für diese Anwendungen beziehen sich zumeist auf die Schnittstellen, enthalten aber auch Anforderungen, die den Betrieb dieser Anwendungen betreffen, sofern sie direkt die Sicherheit des Clusters berühren. Weitere im Kubernetes-Umfeld übliche Dienste, wie z. B. Automatisierung für CI/CD-Pipelines und Codeverwaltung in z. B. Git, behandelt der Baustein nicht in der Tiefe.<BR>Der Baustein modelliert umfassend einen Cluster. Die Anwendungen der Control Plane, Dienste zur Automatisierung und die Nodes, sind hier als eine Gruppe zu sehen und zu behandeln.<BR>Sicherheitsanforderungen für die in Kubernetes-Clustern betriebenen Dienste, wie z. B. Webserver (APP.3.2 Webserver) oder E-Mail-Server (siehe APP.5.3 Allgemeiner E-Mail-Client und -Server), sind Gegenstand eigener Bausteine."
          },
          {
            "name": "2.1. Mangelhafte Authentisierung und Autorisierung in der Control Plane",
            "value": "Um Runtimes, Nodes und auch Kubernetes selbst zu verwalten, benötigen sowohl Administrierende als auch die toolgestützte Bereitstellung administrative Zugänge. Diese Zugänge sind entweder als Unix-Sockets oder Netzports ausgeführt. Mechanismen zur Authentisierung und Verschlüsselung der administrativen Zugänge sind häufig vorhanden, aber nicht bei allen Produkten standardmäßig aktiviert.<BR>Wenn Unbefugte auf das Datennetz oder auf die Nodes zugreifen, können sie über ungeschützte administrative Zugänge Befehle ausführen, die der Verfügbarkeit, Vertraulichkeit und Integrität der verarbeiteten Daten schaden können."
          },
          {
            "name": "2.2. Vertraulichkeitsverlust von Zugangsdaten",
            "value": "Oft benötigen Pods Zugangsdaten (Access Token) für Kubernetes. Über einen Angriff auf den Pod können diese Zugangsdaten in unbefugte Hände gelangen. Mit diesen Zugangsdaten ist es bei Angriffen möglich, mit der Control Plane authentifiziert zu interagieren und, sofern die Berechtigungen ausreichen, auch Veränderungen an der Orchestrierung vorzunehmen."
          },
          {
            "name": "2.3. Ressourcenkonflikte auf Nodes",
            "value": "Einzelne Pods können den Node oder auch die Orchestrierung überlasten und so die Verfügbarkeit aller anderen Pods auf dem Node oder auch den Betrieb des Nodes selbst gefährden."
          },
          {
            "name": "2.4. Unautorisierte Änderungen an Clustern",
            "value": "Die Automatisierung mit CI/CD und die daraus folgende Notwendigkeit, den Werkzeugen privilegierte Zugangsberechtigungen zu erteilen, birgt das Risiko, dass nicht autorisierte Änderungen an Clustern erfolgen. So kann z. B. eine neue Version einer Anwendung auf dem Cluster aufgebracht werden, die nicht ausreichend getestet ist oder die den Freigabeprozess nicht durchlaufen hat. Auch ist es bei Fehlern in den Berechtigungen auf der CI/CD-Umgebung möglich, dass Schadsoftware in die Cluster eindringen und dort Daten auslesen, löschen oder verändern kann."
          },
          {
            "name": "2.5. Unberechtigte Kommunikation",
            "value": "Alle Pods in einem Cluster sind grundsätzlich in der Lage, miteinander, mit den Nodes im eigenen Cluster sowie beliebigen anderen IT-Systemen zu kommunizieren. Sofern diese Kommunikation nicht eingeschränkt ist, kann dies ausgenutzt werden, um z. B. die Control Plane, andere Pods oder die Nodes anzugreifen.<BR>Auch besteht die Gefahr, dass Pods im Cluster unerwünscht von außen erreichbar sind. So kann ein Angriff gegen Dienste, die eigentlich nur innerhalb des Clusters erreichbar sein sollten, von außen erfolgen. Diese Gefährdung wird durch die geringere Aufmerksamkeit verschlimmert, die internen Diensten oft entgegengebracht wird. Wird z. B. eine Verwundbarkeit auf einem nur intern eingesetzten Dienst toleriert und ist dieser auch von außen erreichbar, gefährdet dies den gesamten Cluster erheblich."
          }
        ],
        "control-implementations": [
          {
            "uuid": "60fd29ea-e9ed-4e2b-9bf5-aec2d6aebeae",
            "source": "https://raw.githubusercontent.com/AG-3-Nutzergenerierte-Inhalte/Stand-der-Technik-Bibliothek/refs/heads/main/Kompendien/Grundschutz%2B%2B-Kompendium/profile/virtualisierungslsungen_profile.json",
            "description": "Implementation for all controls in Baustein APP.4.4",
            "implemented-requirements": [
              {
                "uuid": "830ccdec-9e79-4cce-a9da-ee9d7243b952",
                "control-id": "ARCH.7.1",
                "description": "",
                "props": [
                  {
                    "name": "level",
                    "value": "3",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "phase",
                    "value": "Implementation",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "practice",
                    "value": "ARCH",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_c",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_i",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_a",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  }
                ],
                "statements": [
                  {
                    "statement-id": "sys.2.6.a6-m3",
                    "uuid": "392ebb5c-d027-4b38-9954-6dfc7e8ee678",
                    "description": "Maturity Level 3: Defined",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Falls die VDI-Komponenten virtualisiert betrieben werden, SOLLTEN sie auf einer dedizierten Virtualisierungsinfrastruktur betrieben werden."
                      },
                      {
                        "name": "guidance",
                        "value": "Die virtuellen Maschinen, auf denen die VDI-Management-Komponenten (z. B. Connection Broker, Datenbank, Lizenzserver) laufen, werden auf einem separaten Cluster von Hypervisor-Hosts betrieben. Dieser Management-Cluster wird nicht für die Ausführung der regulären virtuellen Clients oder anderer Server-Workloads verwendet, um Ressourcenkonflikte und Sicherheitsrisiken durch Kompromittierung anderer Systeme zu vermeiden."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer verifiziert in der Managementkonsole der Virtualisierungsplattform, dass ein dedizierter Cluster für die VDI-Management-Komponenten existiert. Es wird geprüft, ob auf den Hosts dieses Clusters ausschließlich die vorgesehenen Management-VMs und keine anderen Workloads laufen."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.2.6.a6-m4",
                    "uuid": "8d704b46-3c5f-4145-9d80-d72c21c89e37",
                    "description": "Maturity Level 4: Enhanced",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Nicht nur die Hypervisoren, sondern auch die zugrundeliegende Storage- und Netzwerkinfrastruktur für die VDI-Managementkomponenten sind physisch oder logisch strikt von der Infrastruktur getrennt, die die virtuellen Clients und andere Anwendungen versorgt."
                      },
                      {
                        "name": "guidance",
                        "value": "Der VDI-Management-Cluster verwendet dedizierte Storage-LUNs oder -Volumes und ist an separate Switch-Ports angeschlossen. Der Netzwerkverkehr des Management-Clusters wird über dedizierte VLANs geleitet, die von den VLANs der virtuellen Client-Workloads getrennt sind. Dies verhindert Performance-Engpässe ('Noisy Neighbor'-Problem) und verbessert die Sicherheit."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer untersucht die Konfiguration der Storage- und Netzwerkinfrastruktur. Es wird verifiziert, ob dedizierte Ressourcen (LUNs, VLANs, Switch-Ports) für den VDI-Management-Cluster zugewiesen sind. Die Netzwerk- und Storage-Architekturdiagramme werden auf eine korrekte Trennung geprüft."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.2.6.a6-m5",
                    "uuid": "cbd8cc7a-ede1-44ba-9e16-0f6e0e9083d7",
                    "description": "Maturity Level 5: Comprehensive",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Die VDI-Management-Ebene wird in einer dedizierten Hochsicherheitszone betrieben, idealerweise auf dedizierter physischer Hardware, mit strikten physischen und logischen Zugangskontrollen und intensiver Überwachung. Sie wird als kritische Infrastruktur behandelt."
                      },
                      {
                        "name": "guidance",
                        "value": "Die Server für die VDI-Management-Komponenten sind in einem separaten, zugangsgeschützten Rack im Rechenzentrum untergebracht. Der administrative Zugriff auf diese Systeme ist auf wenige, spezialisierte Administratoren beschränkt und erfordert Multi-Faktor-Authentifizierung und eine Privileged Access Management (PAM)-Lösung. Jegliche Aktivität auf diesen Systemen wird lückenlos protokolliert und analysiert."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer verifiziert die physischen Sicherheitsmaßnahmen für die VDI-Management-Hardware. Die Konfiguration der PAM-Lösung und die Zugriffsberechtigungen werden kontrolliert. Die Protokolle werden auf Vollständigkeit und auf die Analyse durch ein SIEM-System geprüft."
                      }
                    ]
                  }
                ]
              },
              {
                "uuid": "ff5e3419-7837-4742-a76b-8d0affc1f5dc",
                "control-id": "ARCH.8.3",
                "description": "",
                "props": [
                  {
                    "name": "level",
                    "value": "5",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "phase",
                    "value": "Implementation",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "practice",
                    "value": "ARCH",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_c",
                    "value": "false",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_i",
                    "value": "false",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_a",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  }
                ],
                "statements": [
                  {
                    "statement-id": "sys.2.6.a15-m3",
                    "uuid": "2ea980a9-e001-4580-b1ad-a0e9751e8073",
                    "description": "Maturity Level 3: Defined",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Die VDI-Komponenten SOLLTEN redundant ausgelegt werden. Jede Komponente SOLLTE darüber hinaus redundant an die relevanten Netze angeschlossen werden. Falls die VDI-Komponenten auf physischen IT-Systemen betrieben werden, SOLLTEN diese IT-Systeme über redundante Stromversorgung und Datenspeicher verfügen. Falls die VDI-Komponenten virtualisiert betrieben werden, SOLLTEN Mechanismen der Virtualisierungsinfrastruktur für die Hochverfügbarkeit eingesetzt werden."
                      },
                      {
                        "name": "guidance",
                        "value": "Kritische VDI-Komponenten wie Connection Broker und Gateways werden als Cluster mit mindestens zwei Knoten betrieben. Diese werden entweder in einem Aktiv/Aktiv-Modus hinter einem Load Balancer oder in einem Aktiv/Passiv-Cluster mit automatischem Failover betrieben. Bei virtualisierten Komponenten wird die Hochverfügbarkeitsfunktion der Virtualisierungsplattform (z. B. VMware HA, Hyper-V Failover Clustering) genutzt, um die VMs bei einem Host-Ausfall automatisch auf einem anderen Host neu zu starten."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer kontrolliert die Architektur der VDI-Umgebung und verifiziert, dass kritische Komponenten redundant ausgelegt sind. Die Konfiguration des Load Balancers oder des Failover-Clusters wird geprüft. Bei virtualisierten Umgebungen wird die Konfiguration der Hochverfügbarkeitsfunktion des Hypervisors kontrolliert."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.2.6.a15-m4",
                    "uuid": "76111504-2c74-47dc-8287-5094fb2c2c68",
                    "description": "Maturity Level 4: Enhanced",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Die VDI-Lösung ist auf zwei physisch getrennte Rechenzentren in einer Stretched-Cluster-Konfiguration verteilt, was eine standortbezogene Ausfallsicherheit bietet. Der Failover-Prozess wird im Rahmen eines formalen Disaster-Recovery-Plans regelmäßig (z.B. halbjährlich) getestet."
                      },
                      {
                        "name": "guidance",
                        "value": "Die VDI-Infrastruktur erstreckt sich über zwei Standorte mit einer synchronen Speicherspiegelung und einem ausfallsicheren Netzwerk. Im Falle des Ausfalls eines kompletten Standorts kann die VDI-Lösung am verbleibenden Standort weiterbetrieben werden. Die DR-Tests beinhalten einen kontrollierten Failover und Failback der gesamten Umgebung und werden protokolliert."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer fordert den Disaster-Recovery-Plan an und überprüft die Protokolle der letzten DR-Tests. Die Konfiguration der standortübergreifenden Cluster und der Speicherspiegelung wird analysiert. Es wird geprüft, ob die Tests erfolgreich waren und welche Lehren daraus gezogen wurden."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.2.6.a15-m5",
                    "uuid": "45fa4911-49e6-4637-ac7a-fc7037c02557",
                    "description": "Maturity Level 5: Comprehensive",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Eine standortübergreifende Aktiv-Aktiv-Architektur mit Global Server Load Balancing (GSLB) ist implementiert. Benutzer werden automatisch und transparent zum nächstgelegenen oder leistungsfähigsten Rechenzentrum geleitet. Das System kann den Totalausfall eines Standorts ohne Datenverlust und mit nur minimaler oder keiner Serviceunterbrechung für die Benutzer verkraften."
                      },
                      {
                        "name": "guidance",
                        "value": "An beiden Standorten läuft eine vollständige, aktive VDI-Umgebung. Ein GSLB-Dienst (z. B. F5 GTM, Cloudflare Load Balancing) verteilt die eingehenden Benutzeranfragen basierend auf geografischer Nähe, Latenz und Systemgesundheit auf die beiden Standorte. Die Benutzerdaten werden mittels asynchroner Replikation oder einer globalen Dateisystemtechnologie zwischen den Standorten aktuell gehalten."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer verifiziert die Konfiguration des GSLB-Dienstes und die Routing-Richtlinien. Die Architektur wird auf eine echte Aktiv-Aktiv-Fähigkeit geprüft. Es wird ein simulierter Standortausfall durchgeführt (z. B. durch Deaktivieren des GSLB-Endpunkts für einen Standort), um zu beobachten, ob der Datenverkehr automatisch und nahtlos auf den verbleibenden Standort umgeleitet wird."
                      }
                    ]
                  }
                ]
              },
              {
                "uuid": "ca1a7865-51b8-44c3-90b3-16be26521f88",
                "control-id": "BES.2.1.3",
                "description": "",
                "props": [
                  {
                    "name": "level",
                    "value": "1",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "phase",
                    "value": "Initiation",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "practice",
                    "value": "ARCH",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_c",
                    "value": "false",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_i",
                    "value": "false",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_a",
                    "value": "false",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  }
                ],
                "statements": [
                  {
                    "statement-id": "sys.2.6.a1-m1",
                    "uuid": "ef4efcdf-33ca-4991-9164-8ca65ec7f0a6",
                    "description": "Maturity Level 1: Partial",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Die Planung für den VDI-Einsatz erfolgt ad-hoc und konzentriert sich nur auf einen unmittelbaren, begrenzten Anwendungsfall, wie z. B. ein Pilotprojekt. Eine langfristige Strategie oder die Anforderungen der gesamten Benutzerbasis werden nicht berücksichtigt. Leistungsanforderungen werden nur grob geschätzt."
                      },
                      {
                        "name": "guidance",
                        "value": "In dieser Phase werden oft nur die Anzahl der initialen Benutzer und die benötigten Standardanwendungen erfasst. Die Planung wird typischerweise in einem einfachen Dokument oder einer Kalkulationstabelle festgehalten, ohne formale Analyse von Wachstumsraten oder Support-Lebenszyklen."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer stellt fest, ob überhaupt Planungsdokumente existieren. Es wird geprüft, ob die Planung über eine einfache Auflistung von Benutzern und Software hinausgeht und ob grundlegende Aspekte wie Server-Dimensionierung, wenn auch nur oberflächlich, bedacht wurden."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.2.6.a1-m2",
                    "uuid": "3c687c56-f022-44d5-9ba7-114c79d73a9a",
                    "description": "Maturity Level 2: Foundational",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Eine grundlegende Planung für den VDI-Einsatz ist vorhanden. Die Anzahl der zu versorgenden virtuellen Clients und deren generelle Leistungsanforderungen (z.B. für Office-Arbeitsplätze) sind identifiziert. Die Planung ist jedoch nicht detailliert und berücksichtigt Aspekte wie zukünftiges Wachstum oder den Support-Lebenszyklus der Lösung nur am Rande."
                      },
                      {
                        "name": "guidance",
                        "value": "Die Planung umfasst eine initiale Dimensionierung für Server, Storage und Netzwerk basierend auf den aktuellen Benutzerzahlen. Es gibt eine grundlegende Abstimmung zwischen den VDI-Komponenten und der Virtualisierungsplattform, meist basierend auf den Standardempfehlungen des Herstellers."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer verifiziert die Existenz eines Planungsdokuments, das die Anzahl der Clients und die grundlegenden Leistungsanforderungen definiert. Es wird geprüft, ob eine initiale Dimensionierung der VDI-Komponenten vorgenommen wurde und ob der geplante Supportzeitraum erwähnt wird."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.2.6.a1-m3",
                    "uuid": "2235aa29-a167-456d-ada4-bc4d8c7800bb",
                    "description": "Maturity Level 3: Defined",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Die Leistungsanforderungen und Anzahl der benötigten virtuellen Clients sowie die daraus resultierenden Anforderungen an die Dimensionierung der VDI MÜSSEN identifiziert werden. Die VDI-Komponenten MÜSSEN anhand dieser Dimensionierungsanforderungen bedarfsgerecht geplant werden. Die VDI-Komponenten und die genutzte Virtualisierungsinfrastruktur MÜSSEN aufeinander abgestimmt geplant werden. Der Support MUSS für den gesamten geplanten Einsatzzeitraum der VDI-Lösung bei der Planung mitberücksichtigt werden. Die Anzahl virtueller Clients und deren benötigte Leistung pro Virtualisierungsserver MUSS festgelegt werden."
                      },
                      {
                        "name": "guidance",
                        "value": "Ein formales Dokument zur Kapazitätsplanung wird erstellt. Dieses Dokument listet die verschiedenen Benutzerprofile (z. B. Office, Power-User, Entwickler) und deren spezifische Anforderungen an CPU, RAM, GPU und Storage auf. Die Planung berücksichtigt auch die Anforderungen an die Netzwerkinfrastruktur, wie Bandbreite und Latenz. Die Supportverträge für Hard- und Software werden geprüft und auf den geplanten Einsatzzeitraum abgestimmt."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer kontrolliert das Planungsdokument auf Vollständigkeit. Es wird verifiziert, ob die Leistungsanforderungen für verschiedene Client-Typen definiert sind, ob die VDI-Komponenten entsprechend dimensioniert sind und ob ein gültiger Supportvertrag für den geplanten Einsatzzeitraum existiert. Stichprobenartig wird geprüft, ob die Festlegung der maximalen Client-Anzahl pro Server auf nachvollziehbaren Kriterien beruht."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.2.6.a1-m4",
                    "uuid": "035f47dd-f239-4234-b2b1-07cc2ce339fd",
                    "description": "Maturity Level 4: Enhanced",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Die Planung umfasst ein detailliertes Kapazitätsmanagement, das Prognosen für Benutzerwachstum und sich ändernde Anwendungsanforderungen über den gesamten Lebenszyklus der VDI-Lösung beinhaltet. Ein formaler Kapazitätsplan wird erstellt und periodisch (z. B. jährlich) überprüft und angepasst, um sicherzustellen, dass die Ressourcen auch zukünftig ausreichen."
                      },
                      {
                        "name": "guidance",
                        "value": "Die Kapazitätsplanung basiert nicht nur auf Schätzungen, sondern auch auf den Ergebnissen von Pilotphasen oder Messungen bestehender Systeme. Die Planung berücksichtigt auch Lastspitzen und definiert klare Schwellenwerte, bei deren Erreichen eine Erweiterung der Infrastruktur eingeleitet werden muss. Der Plan wird im Configuration Management Board (CMB) genehmigt."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer verifiziert die Existenz eines formalen und genehmigten Kapazitätsplans. Es wird geprüft, ob der Plan Prognosen für zukünftiges Wachstum enthält und ob es einen definierten Prozess zur regelmäßigen Überprüfung und Anpassung des Plans gibt. Protokolle von Überprüfungen werden eingesehen."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.2.6.a1-m5",
                    "uuid": "9bc7f9a9-f25f-476d-b79c-abd27cd37d9b",
                    "description": "Maturity Level 5: Comprehensive",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Die VDI-Planung ist vollständig in die strategische IT-Planung und das Finanzcontrolling integriert. Es werden automatisierte Werkzeuge zur Kapazitätsprognose eingesetzt, die auf Echtzeit-Nutzungsdaten und Trendanalysen basieren. Der Planungsprozess beinhaltet die Simulation von \"Was-wäre-wenn\"-Szenarien, um die Auswirkungen größerer Geschäftsveränderungen (z. B. Firmenzukäufe) proaktiv zu bewerten."
                      },
                      {
                        "name": "guidance",
                        "value": "Spezialisierte Monitoring-Tools sammeln kontinuierlich Leistungs- und Nutzungsdaten der VDI-Umgebung. Diese Daten fließen in ein Prognose-Tool ein, das maschinelles Lernen verwendet, um den zukünftigen Ressourcenbedarf vorherzusagen. Die Ergebnisse werden in einem Management-Dashboard visualisiert und dienen als Grundlage für Investitionsentscheidungen."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer untersucht die Integration des VDI-Planungsprozesses in die übergeordneten Unternehmensprozesse. Es wird die Nutzung von automatisierten Prognose-Werkzeugen verifiziert und geprüft, ob die Ergebnisse der Simulation von Szenarien dokumentiert und bei strategischen Entscheidungen berücksichtigt werden. Ein Auditor kann die Ausführung eines automatisierten Berichts zur Kapazitätsprognose anfordern: `Show-VDIUsageForecast -Period 12Months`."
                      }
                    ]
                  }
                ]
              },
              {
                "uuid": "41965705-b64c-4e7c-96d2-53965176573a",
                "control-id": "DET.3.1.4",
                "description": "",
                "props": [
                  {
                    "name": "level",
                    "value": "3",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "phase",
                    "value": "Operation",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "practice",
                    "value": "DET",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_c",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_i",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_a",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  }
                ],
                "statements": [
                  {
                    "statement-id": "sys.2.6.a11-m3",
                    "uuid": "debb6a7c-9df6-4970-a36d-89b55703bc97",
                    "description": "Maturity Level 3: Defined",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Für die VDI-Komponenten SOLLTEN mindestens die folgenden Ereignisse an ein zentrales Monitoring weitergeleitet werden: erfolgreiche und fehlgeschlagene Anmeldeversuche, Konfigurationsänderungen an VDI-Komponenten oder virtuellen Clients, erfolgreiche und fehlgeschlagene Updates an VDI-Komponenten, fehlgeschlagene Updates an virtuellen Clients. Die VDI-Komponenten SOLLTEN regelmäßig auf Schwachstellen überprüft werden."
                      },
                      {
                        "name": "guidance",
                        "value": "Die Audit-Protokollierung auf allen VDI-Komponenten wird aktiviert, um die geforderten Ereignisse zu erfassen. Ein Log-Forwarding-Agent (z. B. Winlogbeat, Syslog-ng) wird auf den Komponenten installiert, um diese Ereignisse an einen zentralen Log-Management-Server (z. B. ELK-Stack, Graylog) zu senden. Es werden regelmäßige, authentifizierte Schwachstellen-Scans gegen die VDI-Komponenten durchgeführt."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer kontrolliert die Logging-Konfiguration der VDI-Komponenten und des Log-Forwarding-Agenten. Im zentralen Log-Management-System wird stichprobenartig geprüft, ob die geforderten Ereignisse ankommen. Die Konfiguration und die Berichte der letzten Schwachstellen-Scans werden eingesehen."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.2.6.a11-m4",
                    "uuid": "2f7c8506-d55b-48b1-9eeb-843408200864",
                    "description": "Maturity Level 4: Enhanced",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Die gesammelten Protokolldaten werden in einem Security Information and Event Management (SIEM) System mit anderen Datenquellen (z. B. Firewall-Logs, Active Directory-Logs) korreliert. Es sind grundlegende Alarmierungsregeln konfiguriert, um auf verdächtige Ereignisse (z. B. übermäßig viele fehlgeschlagene Anmeldungen von einer IP-Adresse, Konfigurationsänderung außerhalb eines Wartungsfensters) hinzuweisen."
                      },
                      {
                        "name": "guidance",
                        "value": "Im SIEM (z. B. Splunk, QRadar) werden spezielle Parser für die VDI-Logs entwickelt oder importiert. Korrelationsregeln werden erstellt, um einfache Angriffsmuster zu erkennen, z. B. 'Brute-Force-Angriff: 10 fehlgeschlagene Anmeldungen für einen Benutzer innerhalb von 5 Minuten' oder 'Verdächtige Konfigurationsänderung: Administrator ändert eine Richtlinie außerhalb der Geschäftszeiten'."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer untersucht die Konfiguration des SIEM, insbesondere die Parser und Korrelationsregeln für die VDI-Umgebung. Die Alarmierungshistorie wird auf relevante Sicherheitsereignisse und deren Untersuchung durch das Sicherheitsteam geprüft. Es wird verifiziert, ob die Regeln dokumentiert sind."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.2.6.a11-m5",
                    "uuid": "b9020de3-dd60-459e-9723-21debcf7f64a",
                    "description": "Maturity Level 5: Comprehensive",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Es werden User and Entity Behavior Analytics (UEBA) auf die VDI-Protokolldaten angewendet, um anomale Aktivitäten zu erkennen, die von regelbasierten Systemen nicht erfasst werden. Die Ergebnisse von Schwachstellen-Scans werden automatisch in ein Ticketing-System eingespeist, um die Behebung nachzuverfolgen und zu eskalieren."
                      },
                      {
                        "name": "guidance",
                        "value": "Ein UEBA-Modul im SIEM oder ein eigenständiges Tool lernt das normale Verhalten von Benutzern und Systemen (z. B. übliche Anmeldezeiten, genutzte Anwendungen, Datenzugriffsmuster). Es alarmiert bei Abweichungen, wie z. B. einem Administrator, der sich nachts von einem ungewöhnlichen Ort aus anmeldet und große Datenmengen herunterlädt. Die Integration des Schwachstellen-Scanners mit dem ITSM-Tool (z. B. Jira, ServiceNow) erstellt automatisch Tickets für gefundene Schwachstellen und weist sie den zuständigen Teams zu."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer verifiziert die Konfiguration und Funktionsweise des UEBA-Systems. Es werden Beispiel-Alarme für anomales Verhalten analysiert. Die Integration zwischen Schwachstellen-Scanner und Ticketing-System wird geprüft, indem der Lebenszyklus eines Tickets von der Entdeckung einer Schwachstelle bis zu ihrer Behebung nachverfolgt wird."
                      }
                    ]
                  }
                ]
              },
              {
                "uuid": "ca82b3ec-4c2e-43a2-91b7-ba015223625a",
                "control-id": "DET.4.15",
                "description": "",
                "props": [
                  {
                    "name": "level",
                    "value": "3",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "phase",
                    "value": "Operation",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "practice",
                    "value": "PERF",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_c",
                    "value": "false",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_i",
                    "value": "false",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_a",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  }
                ],
                "statements": [
                  {
                    "statement-id": "sys.2.6.a10-m3",
                    "uuid": "faca1e1a-f318-4cb3-a178-c474e182fd75",
                    "description": "Maturity Level 3: Defined",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Der Zustand der VDI-Komponenten SOLLTE zentral überwacht werden. Es SOLLTEN mindestens folgende Parameter für jede VDI-Komponente überwacht werden: Erreichbarkeit der benötigten Netzschnittstellen, Verfügbarkeit der von der VDI-Komponente bereitgestellten Dienste, Auslastung der CPU und des Arbeitsspeichers."
                      },
                      {
                        "name": "guidance",
                        "value": "Ein zentrales Monitoring-System (z. B. Nagios, Zabbix, Prometheus) wird verwendet, um die definierten Parameter zu überwachen. Für jede VDI-Komponente (Broker, Gateway, Datenbank etc.) werden Checks eingerichtet, die regelmäßig die Netzwerk-Erreichbarkeit (Ping), die Verfügbarkeit der spezifischen Dienste (z. B. Port-Check auf dem Broker-Port) und die Basisauslastung von CPU und RAM abfragen. Es sind grundlegende Schwellenwerte definiert, bei deren Überschreitung eine Benachrichtigung an die Administratoren erfolgt."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer kontrolliert die Konfiguration des Monitoring-Systems. Es wird verifiziert, ob alle VDI-Komponenten im Monitoring erfasst sind und ob die geforderten Parameter (Netzwerk, Dienste, CPU, RAM) überwacht werden. Es wird geprüft, ob Alarmierungsregeln konfiguriert sind."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.2.6.a10-m4",
                    "uuid": "547ba72d-ea04-45f4-955c-ac07d92ad236",
                    "description": "Maturity Level 4: Enhanced",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Das Monitoring umfasst anwendungsspezifische Gesundheitsprüfungen (Health Checks) für die VDI-Dienste. Es sind detaillierte Schwellenwerte für Leistungskennzahlen (z.B. Anmeldedauer, Protokolllatenz) definiert, bei deren Überschreitung automatisch Alarme ausgelöst werden. Ein zentrales Dashboard bietet eine Echtzeit-Übersicht über den Gesundheitszustand der gesamten VDI-Umgebung."
                      },
                      {
                        "name": "guidance",
                        "value": "Spezielle Management-Packs oder Plugins für die VDI-Lösung werden im Monitoring-System eingesetzt. Diese führen tiefergehende Prüfungen durch, z. B. die Abfrage von Datenbank-Verbindungspools oder die Messung der Lizenzserver-Antwortzeit. Das Dashboard (z. B. in Grafana) visualisiert die wichtigsten Metriken und den Gesamtstatus der Umgebung auf einen Blick."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer untersucht das Monitoring-Dashboard und die Konfiguration der anwendungsspezifischen Checks. Es wird geprüft, ob die Schwellenwerte für Leistungskennzahlen sinnvoll und dokumentiert sind. Die Alarmierungshistorie wird auf relevante Ereignisse und deren Bearbeitung geprüft."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.2.6.a10-m5",
                    "uuid": "22c0db7e-48dd-43a4-8bcc-b5b1fe5dfc5c",
                    "description": "Maturity Level 5: Comprehensive",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Es wird prädiktives Monitoring eingesetzt. Das System analysiert Trends in der Ressourcennutzung, um potenzielle Engpässe vorauszusagen, bevor sie die Benutzer beeinträchtigen. Synthetische Benutzeranmeldungen werden kontinuierlich von verschiedenen Standorten aus durchgeführt, um die End-to-End-Leistung und -Verfügbarkeit proaktiv zu überwachen."
                      },
                      {
                        "name": "guidance",
                        "value": "Eine Monitoring-Lösung mit AIOps-Funktionen (AI for IT Operations) wird verwendet. Diese analysiert historische Daten, um normale Verhaltensmuster zu lernen und Anomalien zu erkennen. Dedizierte Probes (z. B. LoginVSI, eG Innovations) simulieren rund um die Uhr Benutzeranmeldungen und Anwendungsstarts und messen die Performance. Bei Abweichungen wird proaktiv ein Ticket im ITSM-System erstellt."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer verifiziert die Konfiguration der prädiktiven Analyse- und Synthetik-Monitoring-Tools. Es wird geprüft, ob die Trendanalysen und die Ergebnisse der synthetischen Tests für die Kapazitätsplanung und proaktive Fehlerbehebung genutzt werden. Die Protokolle der letzten simulierten Anmeldungen werden eingesehen."
                      }
                    ]
                  }
                ]
              },
              {
                "uuid": "e5f9b826-1d5c-4e28-a51e-c415935ad833",
                "control-id": "KONF.10.1",
                "description": "",
                "props": [
                  {
                    "name": "level",
                    "value": "3",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "phase",
                    "value": "Implementation",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "practice",
                    "value": "CON",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_c",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_i",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_a",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  }
                ],
                "statements": [
                  {
                    "statement-id": "sys.2.6.a3-m1",
                    "uuid": "21c8dd34-b188-4b8d-b43c-9d4dd7edd0b2",
                    "description": "Maturity Level 1: Partial",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Die VDI-Lösung wird zwar für die Bereitstellung einiger virtueller Clients genutzt, aber viele Clients werden weiterhin manuell direkt im Hypervisor erstellt und konfiguriert. Dies führt zu inkonsistenten Konfigurationen und Sicherheitslücken."
                      },
                      {
                        "name": "guidance",
                        "value": "Häufig werden manuelle VMs für 'dringende' oder 'spezielle' Anforderungen erstellt, da der Prozess über die VDI-Lösung als zu langsam oder zu restriktiv empfunden wird. Diese 'Schatten-VMs' sind oft nicht gehärtet und werden nicht zentral verwaltet."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer vergleicht die Liste der VMs im Hypervisor mit der Liste der verwalteten Clients in der VDI-Konsole. Diskrepanzen deuten auf manuell erstellte VMs hin. Es wird geprüft, ob es Richtlinien gibt, die die Erstellung von VMs regeln."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.2.6.a3-m2",
                    "uuid": "f87f2b8b-8acc-4585-b8e5-319af0b9248c",
                    "description": "Maturity Level 2: Foundational",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Die VDI-Lösung ist das bevorzugte Werkzeug zur Installation und Konfiguration virtueller Clients. Es gibt jedoch keine technischen Kontrollen, die Administratoren daran hindern, bei Bedarf VMs direkt im Hypervisor zu erstellen oder manuell in die VDI-Lösung zu importieren."
                      },
                      {
                        "name": "guidance",
                        "value": "Es existiert eine organisatorische Anweisung, die VDI-Lösung zu verwenden. Die Umsetzung wird jedoch nicht technisch erzwungen, was zu Ausnahmen und Inkonsistenzen führt, insbesondere wenn es um die Konfiguration von importierten VMs geht."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer prüft die Berechtigungen auf der Virtualisierungsinfrastruktur. Es wird untersucht, ob Administratoren, die VDI verwalten, auch die Berechtigung haben, VMs direkt zu erstellen. Protokolle des Hypervisors werden auf manuelle VM-Erstellungs- oder Importvorgänge überprüft."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.2.6.a3-m3",
                    "uuid": "733634d9-c9dd-4ca8-9f59-273892edf149",
                    "description": "Maturity Level 3: Defined",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Die VDI-Lösung SOLLTE genutzt werden, um die virtuellen Clients zu installieren und zu konfigurieren. Virtuelle Clients SOLLTEN NICHT manuell in die VDI-Lösung integriert werden. In der für die VDI verwendeten Virtualisierungsinfrastruktur SOLLTEN virtuelle Clients NICHT unabhängig von der VDI erzeugt werden."
                      },
                      {
                        "name": "guidance",
                        "value": "Die Bereitstellung und Konfiguration von virtuellen Clients erfolgt ausschließlich über die Managementkonsole oder die Automatisierungsschnittstellen der VDI-Lösung. Manuell erstellte VMs werden nicht unterstützt und nicht in die VDI-Umgebung aufgenommen. Dies wird durch entsprechende Prozessvorgaben und organisatorische Regelungen sichergestellt."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer verifiziert den dokumentierten Prozess zur Bereitstellung virtueller Clients. Es wird kontrolliert, ob der Prozess die ausschließliche Nutzung der VDI-Lösung vorschreibt. Die Inventarlisten von VDI-Lösung und Hypervisor werden abgeglichen, um nicht verwaltete VMs zu identifizieren."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.2.6.a3-m4",
                    "uuid": "b40f4324-084b-41e8-89e0-d418d6b7079d",
                    "description": "Maturity Level 4: Enhanced",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Es sind technische Kontrollen implementiert, die Administratoren strikt daran hindern, VDI-verwaltete virtuelle Clients außerhalb der VDI-Managementkonsole zu erstellen oder zu ändern. Dies wird durch eine granulare rollenbasierte Zugriffskontrolle (RBAC) auf der Ebene des Hypervisors durchgesetzt."
                      },
                      {
                        "name": "guidance",
                        "value": "Auf der Virtualisierungsplattform (z. B. vSphere, Hyper-V) werden dedizierte Rollen für VDI-Administratoren erstellt. Diese Rollen gewähren nur die Berechtigungen, die für die VDI-Lösung erforderlich sind (z. B. Power-On/Off), entziehen aber die Berechtigung, neue VMs zu erstellen, zu klonen oder deren Konfiguration (vCPU, RAM) direkt zu ändern. Diese Aktionen sind nur dem VDI-Dienstkonto gestattet."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer überprüft die RBAC-Konfiguration auf der Virtualisierungsplattform. Es wird verifiziert, dass die Berechtigungen der VDI-Administratoren nach dem Prinzip der geringsten Rechte (Least Privilege) konfiguriert sind und die Erstellung von VMs außerhalb der VDI-Lösung technisch unterbunden wird. Ein Auditor kann versuchen, als VDI-Admin eine VM manuell zu erstellen: `New-VM -Name 'Test-VM'` sollte fehlschlagen."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.2.6.a3-m5",
                    "uuid": "2bb6ae66-14d0-4755-ba4c-a1e52367da6a",
                    "description": "Maturity Level 5: Comprehensive",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Der API-Zugriff auf die Virtualisierungsplattform ist auf das dedizierte Dienstkonto der VDI-Lösung beschränkt. Das gesamte Lebenszyklusmanagement von virtuellen Clients ist vollständig automatisiert und wird lückenlos über die Protokolle der VDI-Lösung auditiert, welche in ein SIEM-System eingespeist werden."
                      },
                      {
                        "name": "guidance",
                        "value": "Netzwerk-ACLs oder eine Firewall auf der Verwaltungsschnittstelle des Hypervisors schränken den API-Zugriff auf die IP-Adressen der VDI-Management-Server ein. Jegliche administrative Tätigkeit erfolgt ausschließlich über die VDI-Konsole. Die Audit-Logs der VDI-Lösung werden in Echtzeit an ein SIEM gesendet, wo Korrelationsregeln auf verdächtige Aktivitäten (z. B. Erstellung einer VM außerhalb der Geschäftszeiten) prüfen."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer verifiziert die Netzwerkkontrollen, die den API-Zugriff auf die Hypervisoren einschränken. Es wird die Konfiguration der Log-Weiterleitung von der VDI-Lösung zum SIEM geprüft. Im SIEM wird kontrolliert, ob Alarme für anomale Lebenszyklus-Ereignisse von VMs konfiguriert sind und ob diese funktionieren."
                      }
                    ]
                  }
                ]
              },
              {
                "uuid": "8aac6ceb-322d-46a7-9559-dbc5965d924d",
                "control-id": "KONF.10.4",
                "description": "",
                "props": [
                  {
                    "name": "level",
                    "value": "1",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "phase",
                    "value": "Implementation",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "practice",
                    "value": "CON",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_c",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_i",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_a",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  }
                ],
                "statements": [
                  {
                    "statement-id": "sys.2.6.a2-m1",
                    "uuid": "400c0de5-7500-451b-b3b1-23189b3f3c90",
                    "description": "Maturity Level 1: Partial",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Die Installation der VDI-Komponenten erfolgt mit den Standardeinstellungen des Herstellers („Next, Next, Finish“). Sicherheitsaspekte werden nur minimal oder gar nicht berücksichtigt. Eine Dokumentation der Konfiguration ist lückenhaft oder nicht vorhanden."
                      },
                      {
                        "name": "guidance",
                        "value": "Administratoren installieren die Software oft unter Zeitdruck und ohne die Sicherheitsleitfäden des Herstellers zu lesen. Es werden Standard-Dienstkonten mit übermäßigen Berechtigungen verwendet und die Kommunikation zwischen den Komponenten erfolgt unverschlüsselt."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer stellt fest, ob die Konfiguration der VDI-Komponenten von den unsicheren Standardeinstellungen abweicht. Es wird geprüft, ob eine Dokumentation der vorgenommenen Einstellungen existiert, selbst wenn sie unvollständig ist."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.2.6.a2-m2",
                    "uuid": "0ce630fe-615b-4556-a3cc-ab9759116711",
                    "description": "Maturity Level 2: Foundational",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Die Installation der VDI-Komponenten folgt den grundlegenden Installationsanleitungen des Herstellers. Einige offensichtliche Sicherheitseinstellungen, wie das Ändern von Standardpasswörtern, werden vorgenommen. Die Konfiguration ist jedoch nicht systematisch gehärtet oder auf das Notwendige beschränkt. Eine grundlegende Dokumentation der Installation ist vorhanden."
                      },
                      {
                        "name": "guidance",
                        "value": "Während der Installation werden die wichtigsten Sicherheitsempfehlungen aus der Schnellstart-Anleitung des Herstellers umgesetzt. Die Zuweisung von Clients an Benutzer erfolgt, aber die Absicherung der Kommunikationskanäle wird möglicherweise noch nicht konsequent umgesetzt."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer verifiziert, ob die grundlegenden Sicherheitsempfehlungen des Herstellers (z. B. aus dem „Getting Started Guide“) umgesetzt wurden. Es wird geprüft, ob die Konfiguration dokumentiert ist und ob Standardpasswörter geändert wurden."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.2.6.a2-m3",
                    "uuid": "034530a6-a03f-4d0d-aa7e-f86c59b4fb91",
                    "description": "Maturity Level 3: Defined",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Wenn die VDI-Komponenten installiert und konfiguriert werden, MUSS mindestens berücksichtigt werden, wie auf betrieblich und technisch notwendige Funktionen beschränkt wird, die Kommunikation zwischen VDI-Komponenten abgesichert wird sowie virtuelle Clients sicher den Benutzenden oder Gruppen hiervon zugewiesen werden. Empfehlungen von dem herstellenden Unternehmen der VDI-Lösung für die sichere Konfiguration MÜSSEN berücksichtigt werden. Die Konfigurationen der VDI-Komponenten MÜSSEN geeignet dokumentiert werden."
                      },
                      {
                        "name": "guidance",
                        "value": "Es wird eine Installations-Checkliste verwendet, die auf den Härtungsempfehlungen des Herstellers basiert. Nicht benötigte Dienste und API-Endpunkte der VDI-Komponenten werden deaktiviert. Die Kommunikation zwischen den Komponenten wird durch TLS erzwungen. Die Zuweisungsregeln für virtuelle Clients werden sorgfältig konfiguriert und dokumentiert. Die Dokumentation erfolgt in einem zentralen System wie einem Wiki oder einer CMDB."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer kontrolliert die Konfiguration der VDI-Komponenten anhand der Härtungsleitfäden des Herstellers und der internen Dokumentation. Es wird geprüft, ob die Kommunikation verschlüsselt ist, ob der Funktionsumfang eingeschränkt wurde und ob die Zuweisungsregeln korrekt implementiert sind. Die Qualität und Aktualität der Dokumentation wird bewertet."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.2.6.a2-m4",
                    "uuid": "8e17ed79-4ae6-49d0-87f2-c902e2740bba",
                    "description": "Maturity Level 4: Enhanced",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Es wurde ein formeller Härtungsleitfaden für die VDI-Komponenten entwickelt, der über die Herstellerempfehlungen hinausgeht und auf etablierten Benchmarks (z. B. CIS) basiert. Die Konfigurationen werden zentral in einem Konfigurationsmanagementsystem (z. B. Ansible, Puppet) verwaltet und versioniert. Automatisierte Skripte werden verwendet, um die konsistente Anwendung der Sicherheitseinstellungen sicherzustellen."
                      },
                      {
                        "name": "guidance",
                        "value": "Die Konfiguration der VDI-Komponenten wird als Code (Infrastructure as Code) behandelt. Jede Änderung an der Konfiguration erfordert einen Review- und Genehmigungsprozess. Die Automatisierungsskripte werden regelmäßig ausgeführt, um die Konfiguration zu überprüfen und Konfigurationsdrift zu korrigieren."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer fordert den internen Härtungsleitfaden an und vergleicht ihn mit der implementierten Konfiguration. Die Code-Repositories für die Konfigurationsautomatisierung werden eingesehen. Es wird geprüft, ob ein Change-Management-Prozess für Konfigurationsänderungen etabliert ist. Ein Auditor kann die Ausführung eines Konformitätsprüfungs-Skripts anfordern: `Test-VDIComponentHardening -Profile 'CIS_Level_1'`."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.2.6.a2-m5",
                    "uuid": "0a5657b9-6086-4216-9318-62540f7a26a1",
                    "description": "Maturity Level 5: Comprehensive",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Der gesamte Installations- und Konfigurationsprozess ist vollständig automatisiert (Zero-Touch-Provisioning). Sicherheitskonfigurationen werden kontinuierlich mit Policy-as-Code-Werkzeugen überwacht und durchgesetzt. Jede Abweichung von der definierten Sicherheitsbaseline löst sofort einen Alarm und eine automatisierte Wiederherstellung des Soll-Zustands aus."
                      },
                      {
                        "name": "guidance",
                        "value": "Ein Werkzeug wie HashiCorp Terraform wird für die Bereitstellung der Infrastruktur und ein Werkzeug wie Open Policy Agent (OPA) für die kontinuierliche Validierung der Konfiguration verwendet. Die Sicherheitsrichtlinien (Policies) sind ebenfalls als Code definiert und versioniert. Die Ergebnisse der Konformitätsprüfungen werden in Echtzeit auf einem Sicherheits-Dashboard angezeigt."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer überprüft die Automatisierungs- und Policy-as-Code-Infrastruktur. Es wird verifiziert, dass der Prozess von der Bereitstellung bis zur Überwachung lückenlos ist. Der Prüfer führt testweise eine nicht autorisierte Konfigurationsänderung durch, um zu beobachten, ob diese automatisch erkannt und korrigiert wird und ob ein entsprechender Alarm ausgelöst wird."
                      }
                    ]
                  }
                ]
              },
              {
                "uuid": "1c0e7de7-ee87-4e85-bf2e-89ab13b9c0e2",
                "control-id": "KONF.10.5",
                "description": "",
                "props": [
                  {
                    "name": "level",
                    "value": "5",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "phase",
                    "value": "Implementation",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "practice",
                    "value": "CON",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_c",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_i",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_a",
                    "value": "false",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  }
                ],
                "statements": [
                  {
                    "statement-id": "sys.2.6.a14-m3",
                    "uuid": "37f06958-e043-4d79-acae-65178ca22fb5",
                    "description": "Maturity Level 3: Defined",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Nachdem sie benutzt wurden oder zu einem definierten Zeitpunkt SOLLTEN die virtuellen Clients auf ihren Grundzustand, d. h. auf das zugrundeliegende Template, zurückgesetzt oder bei Bedarf neu provisioniert werden. Diese Zeitfenster SOLLTEN dokumentiert und an die Betroffenen kommuniziert werden. Nicht zurückgesetzte virtuelle Clients SOLLTEN NICHT von mehreren unterschiedlichen Benutzenden verwendet werden."
                      },
                      {
                        "name": "guidance",
                        "value": "Für Anwendungsfälle, die keine persistenten Daten auf dem Client erfordern (z. B. Call-Center, Schulungsräume), werden nicht-persistente Desktop-Pools eingerichtet. Die VDI-Lösung ist so konfiguriert, dass die virtuellen Maschinen nach der Abmeldung des Benutzers automatisch zurückgesetzt oder gelöscht und neu aus dem Master-Template erstellt werden. Die Benutzer werden darüber informiert, dass alle auf dem Desktop gespeicherten Daten verloren gehen."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer kontrolliert die Konfiguration der Desktop-Pools in der VDI-Managementkonsole. Es wird verifiziert, ob die Option zum Zurücksetzen/Löschen nach Abmeldung für die entsprechenden Pools aktiviert ist. Die Kommunikationsunterlagen für die Benutzer werden auf entsprechende Hinweise geprüft. Es wird kontrolliert, ob sichergestellt ist, dass nachfolgende Benutzer eine saubere VM erhalten."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.2.6.a14-m4",
                    "uuid": "d3f04b59-3016-48df-97be-4d1d441de74a",
                    "description": "Maturity Level 4: Enhanced",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Die Clients werden nach jeder Abmeldung automatisch zurückgesetzt. Es sind robuste Mechanismen zur Umleitung von Benutzerprofilen und -daten (z. B. auf einen Netzwerkspeicher) implementiert, um eine nahtlose Benutzererfahrung zu gewährleisten und gleichzeitig die Zustandslosigkeit des Client-Betriebssystems beizubehalten."
                      },
                      {
                        "name": "guidance",
                        "value": "Technologien wie FSLogix Profile Containers oder VMware Dynamic Environment Manager werden verwendet, um das Benutzerprofil und benutzerspezifische Daten in eine virtuelle Festplattendatei (VHDX) auf einem schnellen Dateiserver auszulagern. Beim Anmelden wird diese Datei in den ansonsten zustandslosen Client eingehängt, sodass der Benutzer seine personalisierte Umgebung vorfindet. Nach der Abmeldung wird die Maschine dennoch zurückgesetzt."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer verifiziert die Konfiguration der Profilmanagement-Lösung. Es wird geprüft, ob die Zurücksetzungsrichtlinie für die Clients konsequent auf 'bei Abmeldung' gesetzt ist. Testweise wird eine Datei auf dem Desktop gespeichert, eine Ab- und Neuanmeldung durchgeführt und geprüft, ob die Datei im neuen Client wieder vorhanden ist (was die Profilpersistenz belegt) und der Client selbst zurückgesetzt wurde."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.2.6.a14-m5",
                    "uuid": "d2ed4dcf-1812-4aba-bf5a-452791c53fe6",
                    "description": "Maturity Level 5: Comprehensive",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Die gesamte Benutzersitzung, einschließlich der Anwendungen, wird containerisiert. Nach der Abmeldung wird der Container vollständig zerstört, wodurch keine Spuren der Sitzung auf dem virtuellen Client zurückbleiben. Dies wird mit einer erzwungenen täglichen Neuanmeldung kombiniert, um sicherzustellen, dass jeder Benutzer jeden Tag mit einer sauberen, neu bereitgestellten Umgebung beginnt."
                      },
                      {
                        "name": "guidance",
                        "value": "Anwendungs-Virtualisierungs- oder Layering-Technologien (z. B. VMware App Volumes, Citrix App Layering) werden verwendet, um Anwendungen zur Laufzeit dynamisch an einen Basis-Client anzuhängen, ohne sie zu installieren. Nach der Abmeldung werden diese Anwendungs-Layer wieder entfernt und die Basis-VM zurückgesetzt. Sitzungszeitlimits in der VDI-Richtlinie erzwingen die tägliche Abmeldung."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer untersucht die Konfiguration der Anwendungs-Layering-Lösung und die Zuweisungsregeln. Es wird verifiziert, dass die Basis-VMs keine installierten Anwendungen enthalten. Die Konfiguration der Sitzungszeitlimits wird kontrolliert. Es wird geprüft, ob die Protokolle die Zerstörung und Neuerstellung der Sitzungs-Container nach jeder Abmeldung bestätigen."
                      }
                    ]
                  }
                ]
              },
              {
                "uuid": "18b23c50-2123-4b9a-a01e-e971026cfc4b",
                "control-id": "KONF.11.1",
                "description": "",
                "props": [
                  {
                    "name": "level",
                    "value": "3",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "phase",
                    "value": "Operation",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "practice",
                    "value": "BER",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_c",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_i",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_a",
                    "value": "false",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  }
                ],
                "statements": [
                  {
                    "statement-id": "sys.2.6.a5-m3",
                    "uuid": "07e71136-5838-46b0-ae6d-9afac9ae4f71",
                    "description": "Maturity Level 3: Defined",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Die Mechanismen und Dienste der VDI-Lösung SOLLTEN genutzt werden, um die Zugriffe auf die virtuellen Clients zu steuern und abzusichern. Falls eine zusätzliche Software für diese Zugriffe auf den zugreifenden Clients eingesetzt wird, SOLLTE diese Software standardisiert und zentralisiert bereitgestellt werden."
                      },
                      {
                        "name": "guidance",
                        "value": "Der Zugriff auf die virtuellen Desktops erfolgt ausschließlich über das vom VDI-Hersteller bereitgestellte Gateway und die zugehörige Client-Software. Die Client-Software wird über ein zentrales Softwareverteilungssystem an die Endgeräte der Benutzer verteilt. Direkte RDP- oder SSH-Verbindungen zu den virtuellen Clients werden auf Netzwerkebene blockiert."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer verifiziert, dass der Zugriff auf die VDI-Umgebung über einen definierten Zugriffspunkt (Gateway) erfolgt. Es wird geprüft, ob die Client-Software zentral bereitgestellt und verwaltet wird. Firewall-Regeln werden kontrolliert, um sicherzustellen, dass direkte Verbindungen zu den virtuellen Clients unterbunden sind."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.2.6.a5-m4",
                    "uuid": "3f3aab09-0b53-4d8e-8e1e-bfda3991b06c",
                    "description": "Maturity Level 4: Enhanced",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Die Verwendung des standardisierten VDI-Clients ist obligatorisch und wird technisch erzwungen. Seine Konfiguration wird zentral über Gruppenrichtlinien oder eine Endpoint-Management-Lösung verwaltet, um konsistente Sicherheitseinstellungen (z.B. Deaktivierung der Zwischenablage, keine Laufwerks- oder USB-Umleitung) auf allen Endgeräten sicherzustellen."
                      },
                      {
                        "name": "guidance",
                        "value": "Es werden Gruppenrichtlinien (GPOs) oder Richtlinien in einer UEM-Lösung (Unified Endpoint Management) wie Intune oder Workspace ONE verwendet, um die Konfiguration der VDI-Client-Software vorzugeben. Benutzer können diese sicherheitsrelevanten Einstellungen nicht ändern. Je nach Benutzergruppe können unterschiedliche Richtlinien zur Anwendung kommen (z.B. Entwickler dürfen die Zwischenablage nutzen, Sachbearbeiter nicht)."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer kontrolliert die konfigurierten Gruppenrichtlinien oder UEM-Richtlinien für den VDI-Client. Auf einem Beispiel-Client wird verifiziert, dass die Einstellungen korrekt angewendet wurden und vom Benutzer nicht geändert werden können. Es wird geprüft, ob die Richtlinien dokumentiert und nach dem Prinzip der geringsten Rechte konzipiert sind."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.2.6.a5-m5",
                    "uuid": "77baab39-bd99-4b5a-947c-6bb4c32ad307",
                    "description": "Maturity Level 5: Comprehensive",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Der Zugriff wird über ein sicheres Gateway gesteuert, das vor dem Verbindungsaufbau eine Multi-Faktor-Authentifizierung (MFA) und eine Überprüfung des Gerätezustands (Device Posture Check) erzwingt. Die VDI-Client-Software selbst wird auf dem Endgerät in einer containerisierten oder gehärteten, schreibgeschützten Umgebung ausgeführt, um Angriffe auf den Client zu verhindern."
                      },
                      {
                        "name": "guidance",
                        "value": "Das VDI-Gateway ist mit einem Identity Provider (z.B. Azure AD, Okta) für MFA und einer Endpoint-Security-Lösung (z.B. CrowdStrike, Microsoft Defender for Endpoint) für Posture-Checks integriert. Ein Zugriff wird nur gewährt, wenn der Benutzer MFA bereitstellt UND das Endgerät als konform (z.B. Antivirus aktuell, Festplattenverschlüsselung aktiv) gemeldet wird. Die Client-Software wird als App-V-Paket oder in einem Docker-Container auf dem Endgerät bereitgestellt."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer verifiziert die Konfiguration des VDI-Gateways und dessen Integration mit dem IdP und der Endpoint-Security-Lösung. Es wird testweise versucht, eine Verbindung mit einem nicht-konformen Gerät oder ohne MFA herzustellen. Es wird geprüft, wie die VDI-Client-Software auf den Endgeräten isoliert wird."
                      }
                    ]
                  }
                ]
              },
              {
                "uuid": "19ed211c-cabc-4022-a287-cf79ecd8f392",
                "control-id": "KONF.15.4",
                "description": "",
                "props": [
                  {
                    "name": "level",
                    "value": "3",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "phase",
                    "value": "Operation",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "practice",
                    "value": "ARCH",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_c",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_i",
                    "value": "false",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_a",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  }
                ],
                "statements": [
                  {
                    "statement-id": "sys.2.6.a12-m3",
                    "uuid": "6d7b56fe-b7ab-4476-b6e3-5ebb2bb7344f",
                    "description": "Maturity Level 3: Defined",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Pro Virtualisierungsserver SOLLTE die maximale Leistung festgelegt werden, die dieser für virtuelle Clients zur Verfügung stellen darf. Diese Grenzwerte SOLLTEN in der VDI-Managementkomponente genutzt werden, um bei hoher Auslastung die virtuellen Clients auf verschiedene Virtualisierungsserver zu verteilen."
                      },
                      {
                        "name": "guidance",
                        "value": "In der VDI-Managementkonsole werden für jeden Host oder Cluster maximale Werte für die Anzahl der VMs, die CPU- oder die Speicherauslastung festgelegt. Diese Schwellenwerte basieren auf der Kapazitätsplanung und verhindern eine übermäßige Überbuchung der Ressourcen. Die VDI-Lösung verwendet diese Grenzwerte, um neue VMs auf dem am wenigsten ausgelasteten Host zu platzieren und so eine grundlegende Lastverteilung zu gewährleisten."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer kontrolliert in der VDI-Managementkonsole, ob Grenzwerte für die Host-Auslastung oder die Anzahl der VMs pro Host definiert sind. Es wird geprüft, ob diese Werte mit der Kapazitätsplanung übereinstimmen und ob die Lastverteilungsfunktion aktiviert ist."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.2.6.a12-m4",
                    "uuid": "4ec5cf53-b977-483c-b0dd-63c3569d6848",
                    "description": "Maturity Level 4: Enhanced",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Der Lastverteilungsmechanismus wird basierend auf historischen Leistungsdaten feinjustiert. Bei Platzierungsentscheidungen werden nicht nur CPU und RAM, sondern auch weitere Metriken wie Storage-I/O und Netzwerkbandbreite berücksichtigt, um eine ausgewogenere Verteilung und bessere Performance zu erzielen."
                      },
                      {
                        "name": "guidance",
                        "value": "Die VDI-Lösung oder ein integriertes Tool der Virtualisierungsplattform (z. B. VMware DRS) wird so konfiguriert, dass es bei seinen Entscheidungen auch die Auslastung der Datastores und der Netzwerkadapter berücksichtigt. Die Gewichtung der verschiedenen Metriken wird so angepasst, dass sie den spezifischen Anforderungen der Workloads entspricht (z. B. höhere Gewichtung von I/O für datenbankintensive Anwendungen)."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer untersucht die erweiterte Konfiguration des Lastverteilungsmechanismus. Es wird verifiziert, dass Metriken über CPU/RAM hinaus (wie Storage I/O und Netzwerk) in die Entscheidungsfindung einbezogen werden. Die Konfiguration wird auf Plausibilität und Dokumentation geprüft."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.2.6.a12-m5",
                    "uuid": "753dac57-475b-4abb-9798-28f9f4d9bba5",
                    "description": "Maturity Level 5: Comprehensive",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Ein vollständig automatisierter, richtliniengesteuerter Ressourcenplaner (Scheduler) wird verwendet. Dieser migriert virtuelle Clients in Echtzeit dynamisch zwischen den Hosts, um die Leistung zu optimieren und die Servicequalität für alle Benutzer gemäß vordefinierten Service Level Agreements (SLAs) sicherzustellen."
                      },
                      {
                        "name": "guidance",
                        "value": "Ein fortschrittliches Ressourcenmanagement-Tool (z. B. VMware vRealize Operations, Turbonomic) ist mit der VDI- und Virtualisierungsplattform integriert. Es analysiert kontinuierlich die Auslastung und prognostiziert Engpässe. Basierend auf definierten SLAs (z. B. 'Finanzanwendungen müssen eine Latenz von <5ms haben') führt es proaktiv Live-Migrationen von VMs durch, um Leistungsabfälle zu verhindern, bevor sie auftreten."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer verifiziert die Konfiguration des automatisierten Ressourcenplaners. Es wird kontrolliert, ob SLAs für verschiedene Anwendungskategorien definiert sind. Die Protokolle des Tools werden eingesehen, um die durchgeführten Optimierungsaktionen (z. B. Live-Migrationen) und deren Begründung nachzuvollziehen."
                      }
                    ]
                  }
                ]
              },
              {
                "uuid": "5dba6666-54c4-450d-a1f2-818a29cfbf2c",
                "control-id": "KONF.6.6.1",
                "description": "",
                "props": [
                  {
                    "name": "level",
                    "value": "5",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "phase",
                    "value": "Risk Treatment",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "practice",
                    "value": "ARCH",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_c",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_i",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_a",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  }
                ],
                "statements": [
                  {
                    "statement-id": "sys.2.6.a13-m3",
                    "uuid": "f0970d5c-cc3a-4273-a122-0b0bd12a0e03",
                    "description": "Maturity Level 3: Defined",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Es SOLLTE geprüft werden, ob es Benutzendengruppen gibt, die sich in ihren Berechtigungen so stark unterscheiden, dass die Nutzung einer gemeinsamen VDI-Lösung nicht sinnvoll ist. In diesem Fall SOLLTE jeweils eine eigene VDI-Lösung pro Benutzendengruppe verwendet werden."
                      },
                      {
                        "name": "guidance",
                        "value": "Eine Risikoanalyse identifiziert Benutzergruppen mit stark abweichenden Sicherheitsanforderungen, z. B. Standard-Büroanwender, privilegierte Administratoren und externe Entwickler. Basierend auf dieser Analyse wird die Entscheidung getroffen, für diese Gruppen separate VDI-Umgebungen (d. h. getrennte Sets von Brokern, Gateways, Datenbanken) aufzubauen, um eine logische Trennung zu gewährleisten und das Risiko einer Ausweitung von Kompromittierungen zu minimieren."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer fordert die Risikoanalyse an und prüft, ob die Identifizierung von Benutzergruppen mit unterschiedlichen Schutzbedarfen stattgefunden hat. Es wird verifiziert, ob die dokumentierte Architektur separate VDI-Instanzen für diese Gruppen vorsieht. Die Konfiguration wird überprüft, um sicherzustellen, dass die Benutzer korrekt den jeweiligen VDI-Lösungen zugeordnet sind."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.2.6.a13-m4",
                    "uuid": "fd6742ab-e609-437d-a1ca-fd3586738c5c",
                    "description": "Maturity Level 4: Enhanced",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Die separaten VDI-Umgebungen werden in vollständig isolierten Netzwerksegmenten bereitgestellt und von unterschiedlichen Administratorenteams verwaltet, um eine strikte Funktionstrennung (Separation of Duties) durchzusetzen."
                      },
                      {
                        "name": "guidance",
                        "value": "Jede VDI-Instanz hat ihre eigenen, dedizierten VLANs für Management, interne Kommunikation und Client-Zugriff. Der Netzwerkverkehr zwischen den VDI-Instanzen ist vollständig blockiert. Die administrativen Aufgaben für die hochsichere VDI-Umgebung (z. B. für Administratoren) werden von einem anderen Team wahrgenommen als die der Standard-VDI-Umgebung, was durch unterschiedliche Berechtigungen im Active Directory und auf den Systemen umgesetzt wird."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer untersucht die Netzwerkarchitektur und die Firewall-Regeln, um die vollständige Isolation der VDI-Instanzen zu verifizieren. Die administrativen Berechtigungen werden kontrolliert, um die Umsetzung der Funktionstrennung zu bestätigen. Es wird geprüft, ob unterschiedliche Administratorenkonten für die Verwaltung der verschiedenen Umgebungen verwendet werden."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.2.6.a13-m5",
                    "uuid": "93d26c39-17e3-4509-af89-64bf445c1405",
                    "description": "Maturity Level 5: Comprehensive",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Die separaten VDI-Lösungen sind physisch getrennt (Air-Gapped) oder verwenden hardware-erzwungene Trennungsmechanismen (z. B. separate Hypervisor-Cluster, Storage-Systeme und Netzwerk-Hardware), um die höchstmögliche Sicherheitsgarantie zu bieten."
                      },
                      {
                        "name": "guidance",
                        "value": "Die VDI-Umgebung für hochprivilegierte Benutzer läuft auf einem komplett eigenen Satz physischer Server, die in einem separaten, hochsicheren Bereich des Rechenzentrums stehen. Es gibt keine gemeinsamen Infrastrukturkomponenten (kein gemeinsamer Hypervisor, kein gemeinsames Storage-Array, keine gemeinsame Netzwerk-Core-Switch) mit der Standard-VDI-Umgebung. Der Zugriff erfolgt über eine separate, dedizierte Zugriffslösung."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer verifiziert die physische Trennung der Hardware durch Einsichtnahme in die RZ-Dokumentation und Rack-Pläne. Die Inventarlisten der Hardware werden geprüft, um sicherzustellen, dass keine Komponenten zwischen den Umgebungen geteilt werden. Netzwerkdiagramme werden analysiert, um die physische Trennung der Kommunikationswege zu bestätigen."
                      }
                    ]
                  }
                ]
              },
              {
                "uuid": "5f7389bb-c564-41ca-aee3-2805a04430a9",
                "control-id": "KONF.8.2",
                "description": "",
                "props": [
                  {
                    "name": "level",
                    "value": "3",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "phase",
                    "value": "Operation",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "practice",
                    "value": "TEST",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_c",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_i",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  },
                  {
                    "name": "effective_on_a",
                    "value": "true",
                    "ns": "https://www.bsi.bund.de/ns/grundschutz"
                  }
                ],
                "statements": [
                  {
                    "statement-id": "sys.2.6.a9-m3",
                    "uuid": "0c6c28ac-2363-4384-8e48-10f5e6dc3980",
                    "description": "Maturity Level 3: Defined",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Die virtuellen Clients SOLLTEN, wenn möglich, zentral über die Managementkomponenten der VDI-Lösung verwaltet werden. Die virtuellen Clients SOLLTEN auch im ausgeschalteten Zustand gepatcht werden, falls dies von der VDI-Lösung unterstützt wird. Die Templates, aus denen virtuelle Clients erzeugt werden, SOLLTEN regelmäßig aktualisiert werden."
                      },
                      {
                        "name": "guidance",
                        "value": "Ein definierter Prozess für das Patch-Management von VDI-Clients ist etabliert. Dieser Prozess beinhaltet die regelmäßige (z.B. monatliche) Aktualisierung der Master-Images/Templates. Für persistente Clients wird ein herkömmliches Patch-Management-Tool verwendet. Falls die VDI-Lösung das Patchen von ausgeschalteten VMs unterstützt, wird diese Funktion genutzt, um sicherzustellen, dass auch selten genutzte Clients aktuell bleiben."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer kontrolliert den Patch-Management-Prozess für VDI-Clients. Es wird das Datum der letzten Aktualisierung der Master-Templates verifiziert. Stichprobenartig wird der Patch-Stand von laufenden und ausgeschalteten virtuellen Clients überprüft. Es wird geprüft, ob die Funktion zum Patchen im ausgeschalteten Zustand konfiguriert ist, falls verfügbar."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.2.6.a9-m4",
                    "uuid": "bc446a61-34e3-498a-a567-597c097b775b",
                    "description": "Maturity Level 4: Enhanced",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Der Patch-Prozess ist weitgehend automatisiert. Die Veröffentlichung neuer Sicherheitspatches durch Hersteller löst einen automatisierten Workflow aus, der das Master-Template aktualisiert, eine Test-VM zur Validierung erstellt und nach erfolgreichem Test einen gestaffelten Rollout des aktualisierten Images an die virtuellen Client-Pools durchführt."
                      },
                      {
                        "name": "guidance",
                        "value": "Automatisierungsskripte (z. B. PowerShell, Ansible) überwachen Patch-Quellen. Bei neuen Patches wird das Master-Image automatisch gestartet, gepatcht, heruntergefahren und ein neuer Snapshot erstellt. Anschließend wird eine Testgruppe von Clients mit dem neuen Image aktualisiert. Wenn keine Probleme auftreten, wird das Image schrittweise für alle Benutzer ausgerollt (z. B. zuerst IT, dann Pilotgruppen, dann alle)."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer untersucht den automatisierten Patch-Workflow. Es wird die Konfiguration der Automatisierungsskripte und die Definition der Rollout-Gruppen geprüft. Die Protokolle des Workflows werden eingesehen, um die erfolgreiche Durchführung der letzten Patch-Zyklen zu verifizieren."
                      }
                    ]
                  },
                  {
                    "statement-id": "sys.2.6.a9-m5",
                    "uuid": "3e354cf0-7d36-46ee-bd15-541286e67780",
                    "description": "Maturity Level 5: Comprehensive",
                    "props": [
                      {
                        "name": "statement",
                        "value": "Für nicht-persistente Desktops wird eine regelmäßige (z. B. tägliche) Abmeldung der Benutzer erzwungen, um sicherzustellen, dass sie bei der nächsten Anmeldung einen frischen, vollständig gepatchten Client aus dem neuesten Template erhalten. Für persistente Desktops wird die Patch-Konformität kontinuierlich überwacht, und nicht-konforme Systeme werden automatisch aus dem produktiven Netz isoliert (Quarantäne), bis sie gepatcht sind."
                      },
                      {
                        "name": "guidance",
                        "value": "Sitzungszeitlimits in der VDI-Lösung erzwingen eine tägliche Neuanmeldung. Die Patch-Management-Lösung ist mit dem Network Access Control (NAC)-System integriert. Meldet ein Client einen veralteten Patch-Stand, wird er vom NAC-System automatisch in ein Quarantäne-VLAN verschoben, wo er nur noch den Patch-Server erreichen kann. Nach erfolgreicher Aktualisierung wird der Zugriff wieder freigegeben."
                      },
                      {
                        "name": "assessment-method",
                        "value": "Der Prüfer verifiziert die Konfiguration der Sitzungszeitlimits. Es wird die Integration zwischen Patch-Management und NAC-System geprüft. Testweise wird ein Client mit einem veralteten Patch-Stand simuliert, um zu beobachten, ob die Quarantäne-Funktion korrekt ausgelöst wird. Ein Auditor kann den Status eines Clients abfragen: `Get-ClientComplianceState -ClientName 'Sales-Client-02'`."
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}